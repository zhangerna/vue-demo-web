{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js!/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js!/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue","mtime":1569468807000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport httpClient from \"@/utils/httpclient\";\nimport model from \"@/components/model\";\nimport { getDateString } from \"@/utils/date\";\nexport default {\n  name: \"device\",\n  inject: ['reload'],\n  components: {\n    model: model\n  },\n  data: function data() {\n    return {\n      tableFields: {\n        imei: {\n          label: this.$t('m.common.imei2'),\n          class: \"text-center\"\n        },\n        deviceType: {\n          label: this.$t('m.cloud.device_type')\n        },\n        vin: {\n          label: this.$t('m.common.vin2'),\n          class: \"text-center\"\n        },\n        updateTime: {\n          label: this.$t('m.cloud.last_update_time'),\n          class: \"text-center\"\n        },\n        actions: {\n          label: this.$t('m.vehicle.actions'),\n          class: \"Actions\"\n        }\n      },\n      table: null,\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      totalPages: 0,\n      show: false,\n      unpairVin: '',\n      title: '',\n      content: '',\n      btnGroup: {\n        btnFirst: this.$t('m.tip.b_cancel'),\n        btnSecond: this.$t('m.tip.b_ok')\n      },\n      delId: '',\n      currentOpa: false,\n      searchText: ''\n    };\n  },\n  mounted: function mounted() {\n    this.initData(this.currentPage, this.pageSize);\n  },\n  methods: {\n    initData: function initData(page) {\n      var _this = this;\n\n      httpClient.post(\"/api/v1/vehicle/listBindDevice?pageNo=\".concat(page, \"&pageSize=\").concat(this.pageSize)).then(function (response) {\n        _this.total = response.data.data.rowCount;\n\n        _this.filterData(response.data.data);\n\n        _this.totalPages = response.data.data.totalPages;\n      });\n    },\n    filterData: function filterData(data) {\n      var _this2 = this;\n\n      this.table = data.datas.map(function (item) {\n        return {\n          imei: item.deviceMac,\n          vin: item.vin ? item.vin : 'N/A',\n          id: item.vehicleId,\n          deviceType: item.deviceType ? item.deviceType === 1 ? _this2.$t('m.cloud.device_name_nonda') : _this2.$t('m.cloud.device_name_chelian') : 'N/A',\n          deviceId: item.deviceId,\n          updateTime: getDateString(item.updateTime)\n        };\n      });\n    },\n    changePage: function changePage(page) {\n      this.initData(page, this.pageSize);\n    },\n    unpairVehicle: function unpairVehicle(id, imei) {\n      this.unpairVin = {\n        vin: id,\n        deviceMac: imei\n      };\n      this.currentOpa = 'unpair';\n      this.show = true;\n      this.title = this.$t('m.tip.confirm');\n      this.content = this.$t('m.tip.unpair');\n    },\n    unbindVIn: function unbindVIn() {\n      var _this3 = this;\n\n      httpClient.post('/api/v1/vehicle/unbind/device', {\n        deviceMac: this.unpairVin.deviceMac,\n        vin: this.unpairVin.vin\n      }).then(function (response) {\n        if (response.data.code == 200) {\n          _this3.reload();\n        } else {\n          _this3.show = true;\n          _this3.title = _this3.$t('m.tip.error');\n          _this3.content = _this3.$t('m.tip.unbind_err');\n          _this3.btnGroup.btnSecond = '';\n        }\n      });\n    },\n    delDevice: function delDevice() {\n      var _this4 = this;\n\n      httpClient.post('/api/v1/device/delete', {\n        deviceId: this.delId\n      }).then(function (response) {\n        if (response.data.code == 200) {\n          _this4.reload();\n        } else {\n          _this4.show = true;\n          _this4.title = _this4.$t('m.tip.error');\n          _this4.content = _this4.$t('m.tip.delete_err');\n          _this4.btnGroup.btnSecond = '';\n        }\n      });\n    },\n    closeBox: function closeBox(type) {\n      if (type) {\n        this.currentOpa == \"del\" ? this.delDevice() : this.unbindVIn();\n      } else {\n        this.show = false;\n      }\n    },\n    delIdM: function delIdM(id) {\n      this.delId = id;\n      this.currentOpa = 'del';\n      this.show = true;\n      this.title = this.$t('m.tip.warn');\n      this.content = this.$t('m.tip.del_device');\n    },\n    searchResult: function searchResult() {\n      var _this5 = this;\n\n      httpClient.post(\"/api/v1/vehicle/listBindDevice\", {\n        imei: this.searchText\n      }).then(function (res) {\n        _this5.total = res.data.data.rowCount;\n\n        _this5.filterData(res.data.data);\n\n        _this5.totalPages = res.data.data.totalPages;\n      });\n    }\n  }\n};",null]}