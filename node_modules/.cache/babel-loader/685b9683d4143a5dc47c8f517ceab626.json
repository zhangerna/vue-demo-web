{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js!/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/alerts.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/alerts.vue","mtime":1574414921000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport httpclient from '@/utils/httpclient';\nimport { getDateString } from \"../../../utils/date\";\nexport default {\n  name: \"alerts\",\n  data: function data() {\n    return {\n      currentPage: 1,\n      pageSize: 10,\n      total: 0,\n      show: false,\n      tableFields: {\n        alertType: {\n          label: this.$t('m.alert.type'),\n          class: \"text-center\"\n        },\n        vehicle: {\n          label: this.$t('m.common.vehicle'),\n          class: \"text-center\"\n        },\n        stockNo: {\n          label: this.$t('m.common.stock_num2'),\n          class: \"text-center\"\n        },\n        time: {\n          label: this.$t('m.common.time'),\n          class: \"text-center\"\n        },\n        status: {\n          label: this.$t('m.common.status'),\n          class: \"text-center\"\n        },\n        action: {\n          label: this.$t('m.common.action'),\n          class: \"text-center\"\n        }\n      },\n      data: null,\n      table: null,\n      pageCount: 0,\n      updateInfo: ''\n    };\n  },\n  mounted: function mounted() {\n    this.axiosData(this.currentPage);\n  },\n  methods: {\n    axiosData: function axiosData(pageNo) {\n      var _this = this;\n\n      httpclient.post(\"/api/v1/alert/list?pageNo=\".concat(pageNo, \"&pageSize=10\")).then(function (response) {\n        _this.total = response.data.data.rowCount;\n        _this.data = response.data.data;\n        _this.pageCount = response.data.data.totalPages;\n\n        _this.filterData();\n      });\n    },\n    filterData: function filterData() {\n      var _this2 = this;\n\n      this.table = this.data.datas.map(function (item) {\n        var year = item.year ? item.year : 'N/A';\n        var make = item.make ? item.make : 'N/A';\n        var model = item.model ? item.model : 'N/A';\n        console.log(item);\n        var alertTypeText = null;\n\n        if (item.alertType === 1) {\n          alertTypeText = _this2.$t('m.alert.alert_type_1');\n        } else if (item.alertType === 2) {\n          alertTypeText = _this2.$t('m.alert.alert_type_2');\n        } else if (item.alertType === 3) {\n          alertTypeText = _this2.$t('m.alert.alert_type_3');\n        } else if (item.alertType === 4) {\n          alertTypeText = _this2.$t('m.alert.alert_type_4');\n        } else if (item.alertType === 5) {\n          alertTypeText = _this2.$t('m.alert.alert_type_5');\n        }\n\n        return {\n          \"alertType\": alertTypeText,\n          \"vehicle\": \"\".concat(year, \" \").concat(make, \" \").concat(model),\n          \"stockNo\": item.stockNum ? item.stockNum : 'N/A',\n          \"time\": item.createTime ? getDateString(item.createTime) : 'N/A',\n          \"status\": item.alertStatus,\n          'id': item.id,\n          \"alertAction\": item.alertMarkAction\n        };\n      });\n    },\n    changeFL: function changeFL(type) {\n      this.axiosData(type == 'f' ? 1 : this.pageCount);\n    },\n    prevPage: function prevPage() {\n      this.axiosData(this.currentPage > 1 ? this.currentPage - 1 : 1);\n    },\n    nextPage: function nextPage() {\n      this.axiosData(this.currentPage >= this.pageCount ? this.currentPage : this.currentPage + 1);\n    },\n    changePage: function changePage(page) {\n      this.axiosData(page);\n    },\n    reload: function reload() {\n      window.location.reload();\n    },\n    updateVehicle: function updateVehicle(id) {\n      var self = this;\n      httpclient.post('/api/v1/alert/update/status', {\n        alertId: id\n      }).then(function (response) {\n        if (response.data.code == 200) {\n          self.updateInfo = self.$t('m.tip.edit_succ');\n          self.show = true;\n        } else {\n          self.updateInfo = self.$t('m.tip.update_failed');\n          self.show = true;\n        }\n      }).catch(function (error) {});\n    }\n  }\n};",{"version":3,"sources":["alerts.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"animated fadeIn alerts\">\n        <b-card>\n            <div slot=\"header\">\n                {{ $t('m.dashboard.alerts') }}\n            </div>\n            <b-table class=\"table-outline\" small striped responsive=\"sm\" :items=\"table\" hover :fields=\"tableFields\" head-variant=\"light\">\n                <template slot=\"status\" slot-scope=\"data\">\n                    <span class=\"badge badge-pill\" :class=\"data.item.status == 1 ? 'badge-success' : 'badge-danger'\">\n                        {{ data.item.status == 1 ? (data.item.alertAction == 'Read' ? $t('m.alert.read_status') : $t('m.alert.solved_status')) : (data.item.alertAction == 'Read' ? $t('m.alert.unread_status') : $t('m.alert.unsolved_status')) }}\n                    </span>\n                </template>\n                <template slot=\"action\" slot-scope=\"data\">\n                    <div class=\"btn btn-sm btn-info m-1\" v-b-tooltip.hover :title=\"$t('m.tooltip.check_detail')\" @click=\"$router.push('/inventory/alerts/detail/' + data.item.id)\">\n                        <i class=\"fa fa-eye\"></i>\n                    </div>\n                    <template v-if=\"data.item.status == 1\">\n                        <div class=\"btn btn-sm btn-update btn-secondary\" v-b-tooltip.hover :title=\"$t('m.common.alert_resolve')\" disabled>\n                            <i class=\"icons cui-check\"></i>\n                        </div>\n                    </template>\n                    <template v-else>\n                        <div class=\"btn btn-sm btn-update btn-success\" v-b-tooltip.hover :title=\"$t('m.common.alert_resolve')\" @click=\"updateVehicle(data.item.id)\">\n                            <i class=\"icons cui-check\"></i>\n                        </div>\n                    </template>\n                </template>\n            </b-table>\n\n            <b-row v-if=\"total > 0\" class=\"paginate-alert\">\n                <b-col sm=\"4\" lg=\"4\">\n                    <div class=\"dataTables_info\" id=\"DataTables0\" role=\"status\" aria-live=\"polite\">\n                        {{ $t('m.common.show') }} {{10 * (currentPage - 1) + 1 }} {{ $t('m.common.to') }} {{currentPage === pageCount? total :currentPage * 10 }} {{ $t('m.common.of') }} {{total}} {{ $t('m.common.entries') }}\n                    </div>\n                </b-col>\n                <b-col sm=\"8\" lg=\"8\">\n                    <b-pagination align=\"right\" :total-rows=\"total\" v-model=\"currentPage\" :per-page=\"pageSize\" aria-controls=\"my-table\" @input=\"changePage(currentPage)\"></b-pagination>\n                </b-col>\n            </b-row>\n        </b-card>\n        <b-modal ref=\"my-modal\" hide-footer :title=\"$t('m.tip.info')\" v-model=\"show\" @ok=\"show = false\">\n            <div>{{ updateInfo }} </div>\n            <b-button class=\"btn btn-primary\" style=\"float: right\" @click=\"reload()\">{{ $t('m.tip.b_ok') }}</b-button>\n        </b-modal>\n    </div>\n</template>\n\n<style lang=\"scss\">\n    .paginate-alert{\n        margin-top: 20px;\n    }\n    .card-header span{\n        margin-left: 10px;\n    }\n    .table {\n        margin-bottom: 0;\n    }\n    .alerts {\n        .btn {\n            color: #ffffff;\n        }\n        .bv-d-xs-down-none {\n            display: none;\n        }\n        .modal {\n            .modal-body button {\n                color: #fff;\n                background-color: #20a8d8;\n                border-color: #20a8d8;\n            }\n        }\n    }\n</style>\n\n<script>\n    import httpclient from '@/utils/httpclient';\n    import { getDateString } from \"../../../utils/date\";\n\n    export default {\n        name: \"alerts\",\n        data() {\n            return {\n                currentPage: 1,\n                pageSize: 10,\n                total: 0,\n                show: false,\n                tableFields: {\n                    alertType: {\n                        label: this.$t('m.alert.type'),\n                        class: \"text-center\"\n                    },\n                    vehicle: {\n                        label: this.$t('m.common.vehicle'),\n                        class: \"text-center\"\n                    },\n                    stockNo: {\n                        label: this.$t('m.common.stock_num2'),\n                        class: \"text-center\"\n                    },\n                    time: {\n                        label: this.$t('m.common.time'),\n                        class: \"text-center\"\n                    },\n                    status: {\n                        label: this.$t('m.common.status'),\n                        class: \"text-center\"\n                    },\n                    action: {\n                        label: this.$t('m.common.action'),\n                        class: \"text-center\"\n                    }\n                },\n                data: null,\n                table: null,\n                pageCount: 0,\n                updateInfo: ''\n            }\n        },\n        mounted(){\n            this.axiosData(this.currentPage);\n        },\n        methods: {\n            axiosData(pageNo) {\n                httpclient.post(`/api/v1/alert/list?pageNo=${pageNo}&pageSize=10`)\n                    .then(response => {\n                        this.total = response.data.data.rowCount;\n                        this.data = response.data.data;\n                        this.pageCount = response.data.data.totalPages;\n                        this.filterData();\n                    })\n            },\n            filterData() {\n                this.table = this.data.datas.map((item) => {\n                   let year = item.year ? item.year : 'N/A';\n                   let make = item.make ? item.make : 'N/A';\n                   let model = item.model ? item.model : 'N/A';\n                   console.log(item)\n                    let alertTypeText=null;\n                    if(item.alertType === 1){\n                        alertTypeText = this.$t('m.alert.alert_type_1')\n                    }else if(item.alertType === 2){\n                        alertTypeText = this.$t('m.alert.alert_type_2')\n                    }else if(item.alertType === 3){\n                        alertTypeText = this.$t('m.alert.alert_type_3')\n                    }else if(item.alertType === 4){\n                        alertTypeText = this.$t('m.alert.alert_type_4')\n                    }else if(item.alertType === 5){\n                        alertTypeText = this.$t('m.alert.alert_type_5')\n                    }\n\n                    return {\n                        \"alertType\" : alertTypeText,\n                        \"vehicle\": `${year} ${make} ${model}`,\n                        \"stockNo\": item.stockNum ? item.stockNum : 'N/A',\n                        \"time\": item.createTime ? getDateString(item.createTime) : 'N/A',\n                        \"status\": item.alertStatus,\n                        'id': item.id,\n                        \"alertAction\": item.alertMarkAction\n                    }\n                });\n            },\n            changeFL(type) {\n                this.axiosData(type == 'f' ? 1 : this.pageCount)\n            },\n            prevPage(){\n                this.axiosData(this.currentPage > 1  ? this.currentPage - 1 : 1)\n            },\n            nextPage(){\n                this.axiosData(this.currentPage >= this.pageCount  ? this.currentPage : this.currentPage + 1)\n            },\n            changePage(page) {\n                this.axiosData(page);\n            },\n            reload() {\n                window.location.reload();\n            },\n            updateVehicle(id) {\n                let self = this;\n                httpclient.post('/api/v1/alert/update/status', {\n                    alertId: id\n                }).then(response => {\n                    if (response.data.code == 200) {\n                        self.updateInfo = self.$t('m.tip.edit_succ');\n                        self.show = true;\n                    } else {\n                        self.updateInfo = self.$t('m.tip.update_failed');\n                        self.show = true;\n                    }\n                }).catch(error => {\n                })\n            }\n        }\n    }\n</script>\n"],"sourceRoot":"src/views/dashboard/dashboardMain"}]}