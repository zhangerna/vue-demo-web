{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js!/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicleEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicleEdit.vue","mtime":1559546167000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _parseInt from \"/Users/nonda/nonda/nonda-saas-web/node_modules/@babel/runtime-corejs2/core-js/parse-int\";\nimport \"core-js/modules/es6.array.find-index\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { getDateString, getYMDString } from '@/utils/date';\nimport httpClient from '@/utils/httpclient';\nimport googleMap from '@components/googleMap';\nimport Alert from '@components/model';\nexport default {\n  name: 'edit',\n  components: {\n    googleMap: googleMap,\n    Alert: Alert\n  },\n  data: function data() {\n    return {\n      id: this.$router.currentRoute.params.id,\n      image: '',\n      year: '',\n      lot: '',\n      vin: '',\n      priceUnit: '',\n      iMei: '',\n      price: '',\n      make: '',\n      color: '',\n      Odometer: '',\n      modal: '',\n      trim: '',\n      isOnline: '',\n      lastUpdateTime: '',\n      lastLocation: '',\n      engineType: '',\n      stockNumber: '',\n      plateNumber: '',\n      inventoryDate: '',\n      condition: '',\n      inventoryTime: '',\n      currentMileage: '',\n      selectedOption: '',\n      selectedCondition: '',\n      file: \"\",\n      boxOne: '',\n      lastLocationLat: '',\n      showAlerts: {\n        title: '',\n        show: false,\n        content: '',\n        buttonText: ''\n      },\n      colorList: ['Black', 'White', 'Silver', 'Blue', 'Red', 'Brown', 'Gold', 'Orange', 'Yellow', 'Purple', 'Green', 'Pink', 'Others'],\n      conditionList: ['New', 'Used', 'Demo'],\n      map: {},\n      imgData: {\n        accept: \"image/gif, image/jpeg, image/png, image/jpg\"\n      }\n    };\n  },\n  mounted: function mounted() {\n    //初始化各项数据\n    var that = this;\n    var url = 'https://api-saas-qa.zus.ai/api/v1/vehicle/detail/id?vehicleId=' + that.id;\n    httpClient.get(url).then(function (res) {\n      var myData = res.data.data;\n      that.image = myData.photoPath;\n      that.year = myData.year;\n      that.vin = myData.vin;\n      that.inventoryTime = myData.inventoryTime;\n      that.currentMileage = myData.currentMileage;\n      that.lot = myData.parkingLot;\n      that.iMei = myData.deviceMac;\n      that.price = myData.price;\n      that.priceUnit = myData.priceUnit;\n      that.color = myData.color;\n      that.Odometer = Math.round(myData.currentMileage * 0.0006214);\n      that.make = myData.make;\n      that.lastLocationLat = myData.lastLocationLat;\n      that.modal = myData.model;\n      that.trim = myData.trim;\n      that.engineType = myData.engineType;\n      that.condition = myData.vehicleType;\n      that.stockNumber = myData.stockNumber;\n      that.plateNumber = myData.plate;\n\n      var _i = that.colorList.findIndex(function (val) {\n        return val === that.color;\n      });\n\n      that.selectedOption = that.colorList[_i];\n\n      var _j = that.conditionList.findIndex(function (val) {\n        return val === that.condition;\n      });\n\n      that.selectedCondition = that.conditionList[_j];\n      that.lastLocation = myData.lastLocation;\n      that.isOnline = myData.adapter === 'Online' ? 'Online' : 'Offline';\n      myData.lastUpdateTime !== null ? that.lastUpdateTime = getDateString(myData.lastUpdateTime) : that.lastUpdateTime = 'N/A';\n      myData.inventoryTime !== null ? that.inventoryDate = getYMDString(myData.inventoryTime) : '';\n      that.map = {\n        lat: myData.lastLocationLat === null ? '' : myData.lastLocationLat,\n        lng: myData.lastLocationLng === null ? '' : myData.lastLocationLng,\n        area: myData.areaCoordinates === null ? '' : myData.areaCoordinates,\n        vehicleInfo: 'info'\n      };\n    });\n  },\n  methods: {\n    getFile: function getFile(event) {\n      //图片上传\n      this.file = event.target.files[0];\n      var formData = new FormData();\n      formData.append(\"file\", this.file); //‘file’是後台接收文件名\n\n      var config = {\n        headers: {\n          \"Content-Type\": \"multipart/form-data\"\n        }\n      };\n      var self = this;\n      httpClient.post(\"https://api-saas-qa.zus.ai/api/v1/uploadFile\", formData, config).then(function (res) {\n        if (res.data.code === 200) {\n          var passData = {\n            title: 'Photo Upload',\n            show: true,\n            content: 'Photo Uploaded Successfully',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n\n        self.image = res.data.data.path;\n      }).catch(function (err) {\n        if (err) {\n          var passData = {\n            title: 'Photo Upload',\n            show: true,\n            content: 'Photo Upload Failed',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n      });\n    },\n    saveData: function saveData() {\n      //设备参数更新，保存\n      var carType = this.selectedCondition;\n\n      if (carType === 'New') {\n        carType = 1;\n      } else if (carType === 'Used') {\n        carType = 3;\n      } else {\n        carType = 2;\n      }\n\n      function convertDateToTime(strtime) {\n        var date = new Date(strtime);\n        return date.getTime();\n      }\n\n      function isInteger(obj) {\n        return typeof obj === 'number' && obj % 1 === 0;\n      }\n\n      var _time = convertDateToTime(this.inventoryDate);\n\n      var dataTime;\n\n      if (_time && isInteger(_time)) {\n        dataTime = _time;\n      }\n\n      var _data = {\n        color: this.selectedOption,\n        currentMileage: _parseInt(this.currentMileage) > 0 ? this.currentMileage * 1609.344 : null,\n        engineType: this.engineType,\n        id: this.$router.currentRoute.params.id,\n        inventoryTime: dataTime,\n        make: this.make,\n        model: this.modal,\n        photoPath: this.image,\n        plat: this.plateNumber,\n        price: this.price,\n        stockNumber: this.stockNumber,\n        trim: this.trim,\n        vehicleType: carType,\n        year: this.year\n      };\n      var link = \"https://api-saas-qa.zus.ai/api/v1/vehicle/update\";\n      var self = this;\n      httpClient.post(link, _data).then(function (res) {\n        if (res.data.data && res.data.data.result) {\n          var passData = {\n            title: 'Vehicle Update',\n            show: true,\n            content: 'Success!',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n      }).catch(function (err) {\n        if (err) {\n          var passData = {\n            title: 'Vehicle Update',\n            show: true,\n            content: 'Failed!',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n      });\n    },\n    unPairdevice: function unPairdevice() {\n      //设备解绑，未绑定的设备，按钮不显示\n      var link = '/api/v1/vehicle/bind/device';\n      var self = this;\n      var data = {\n        deviceMac: this.iMei,\n        vin: this.vin\n      };\n      httpClient.post(link, data).then(function (res) {\n        if (res.data.code === 200) {\n          var passData = {\n            title: 'Vehicle Unpair',\n            show: true,\n            content: 'Success!',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n      }).catch(function (err) {\n        if (err) {\n          var passData = {\n            title: 'Vehicle Unpair',\n            show: true,\n            content: 'Failed!',\n            buttonText: {\n              btnFirst: '',\n              btnSecond: 'OK'\n            }\n          };\n          self.closeRemind(passData);\n        }\n      });\n    },\n    closeRemind: function closeRemind(data) {\n      this.showAlerts.show = data.show;\n      this.showAlerts.title = data.title;\n      this.showAlerts.content = data.content;\n      this.showAlerts.buttonText = data.buttonText;\n    },\n    closeBox: function closeBox() {\n      //子组件来请求父组件关闭弹窗\n      this.showAlerts.show = !this.showAlerts.show;\n    }\n  }\n};",{"version":3,"sources":["vehicleEdit.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"animated fadeIn\">\n    <b-container class=\"bv-example-row\">\n      <h6><i class=\"fa fa-edit\"></i> Edit Vehicle</h6>\n      <b-row>\n        <b-col class=\"col-3\"><img :src=\"image\" alt=\"\" width=\"100%\"></b-col>\n        <b-col class=\"col-9\">\n          <div class=\"justify-content-between specific-data\">\n            <div>\n              <b-modal id=\"modal-1\" title=\"Google Map\" v-if=\"lastLocationLat\">\n                <google-map :map=\"map\"></google-map>\n              </b-modal>\n              <Alert @closeRemindBox ='closeBox()' :buttonText=\"showAlerts.buttonText\" :show=\"showAlerts.show\" :title=\"showAlerts.title\" :content=\"showAlerts.content\"></Alert>\n            </div>\n            <div class=\"d-flex justify-content-between\"><span>Last Location</span><span class=\"text-center\">{{lastLocation}}</span><span class=\"text-right google-maps\" v-b-modal.modal-1><i class=\"cui cui-location-pin\"></i></span></div>\n            <div class=\"d-flex justify-content-between\"><span>Last Update</span><span class=\"text-right\">{{lastUpdateTime}}</span></div>\n            <div class=\"d-flex justify-content-between\"><span>Lot</span><span class=\"text-right\">{{lot}}</span></div>\n            <div class=\"d-flex justify-content-between\"><span>Online/Offline</span><span class=\"online\">{{isOnline}}</span></div>\n          </div>\n        </b-col>\n        <b-col class=\"col-6\">\n          <label for=\"imei\">Device IMEI</label>\n          <b-form-input id=\"imei\" disabled=\"disabled\" v-model=\"iMei\"></b-form-input>\n        </b-col>\n        <b-col class=\"col-6\">\n          <label for=\"imei\">Vehicle VIN</label>\n          <b-form-input id=\"vin\" v-model=\"vin\" disabled=\"disabled\"></b-form-input>\n        </b-col>\n      </b-row>\n\n      <form class=\"form-horizontal needs-validation\" method=\"post\" novalidate=\"\" id=\"vehicleForm\">\n        <div class=\"row justify-content-center\">\n          <input class=\"form-control\" name=\"id\" id=\"vehicleId\" type=\"hidden\" value=\"\">\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"year\">Year</label>\n              <input class=\"form-control\" name=\"year\" id=\"vehicleyear\" type=\"text\" v-model=\"year\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"make\">Make</label>\n              <input class=\"form-control\" name=\"make\" id=\"vehiclemake\" type=\"text\" v-model=\"make\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"model\">Model</label>\n              <input class=\"form-control\" name=\"model\" id=\"vehiclemodel\" type=\"text\"  v-model=\"modal\">\n            </div>\n          </div>\n        </div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group required\">\n              <label class=\"\" for=\"Trim\">Trim</label>\n              <input class=\"form-control\" name=\"trim\" id=\"vehicletrim\" type=\"text\" v-model=\"trim\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Engine\">Engine</label>\n              <input class=\"form-control\" name=\"engineType\" id=\"vehicleengine\" type=\"text\" v-model=\"engineType\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Color\">Color</label>\n              <select class=\"form-control\" name=\"color\" id=\"vehiclecolor\" v-model=\"selectedOption\">\n                <option v-for=\"item in colorList\">{{item}}</option>\n              </select>\n            </div>\n          </div>\n        </div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Price\">Price</label><br>\n              <strong><span class=\"text-muted text-\" id=\"priceUnit\" style=\"float:left;margin-top:6px;\">{{priceUnit}}</span></strong>\n              <input class=\"form-control col-11\" name=\"price\" id=\"vehicleprice\" type=\"text\" v-model=\"price\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Stock\">Stock Number</label>\n              <input class=\"form-control\" name=\"stockNumber\" id=\"vehiclestock\" type=\"text\" v-model=\"stockNumber\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"date\">Inventory Date</label>\n              <input class=\"form-control\" name=\"\" id=\"vehicleinventory\" type=\"date\" v-model=\"inventoryDate\">\n            </div>\n          </div>\n        </div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Status\">Condition</label>\n              <select class=\"form-control\" name=\"\" id=\"vehicletype\" v-model=\"selectedCondition\">\n                <option v-for=\"item in conditionList\">{{item}}</option>\n              </select>\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Odometer\">Odometer</label>\n              <input class=\"form-control\" name=\"currentMileage\" id=\"vehiclemileage\" type=\"text\" v-model=\"Odometer\">\n            </div>\n          </div>\n          <div class=\"col-sm-6 col-lg-4\">\n            <div class=\"form-group\">\n              <label for=\"Plate\">Plate Number</label>\n              <input class=\"form-control\" name=\"plat\" id=\"vehicleplat\" type=\"text\" v-model=\"plateNumber\">\n            </div>\n          </div>\n        </div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-sm-12 col-lg-4\">\n            <input type=\"file\" @change=\"getFile($event)\">\n          </div>\n        </div>\n        <div class=\"row justify-content-center\">\n          <div class=\"col-6 text-center\">\n            <button class=\"btn btn-success mx-3 px-3\" type=\"button\" id=\"updatebtn\" @click=\"saveData\">\n              Save\n            </button>\n            <button class=\"btn btn-danger mx-3\" type=\"button\" v-if=\"iMei && vin\" id=\"unpairbtn\" @click=\"unPairdevice\">Unpair\n            </button>\n          </div>\n        </div>\n      </form>\n\n    </b-container>\n  </div>\n\n</template>\n<script>\n  import {getDateString,getYMDString} from '@/utils/date';\n\timport httpClient from '@/utils/httpclient';\n\timport googleMap from '@components/googleMap'\n  import Alert from '@components/model'\n\texport default {\n\t\tname: 'edit',\n\t\tcomponents:{\n\t\t\tgoogleMap,Alert\n    },\n\t\tdata() {\n\t\t\treturn {\n\t\t\t\tid: this.$router.currentRoute.params.id,\n\t\t\t\timage: '',\n        year:'',\n        lot:'',\n\t\t\t\tvin: '',\n        priceUnit:'',\n        iMei:'',\n        price:'',\n        make:'',\n        color:'',\n\t\t\t\tOdometer:'',\n        modal:'',\n        trim:'',\n        isOnline:'',\n\t\t\t\tlastUpdateTime:'',\n\t\t\t\tlastLocation:'',\n\t\t\t\tengineType:'',\n\t\t\t\tstockNumber:'',\n\t\t\t\tplateNumber:'',\n\t\t\t\tinventoryDate:'',\n\t\t\t\tcondition:'',\n\t\t\t\tinventoryTime:'',\n\t\t\t\tcurrentMileage:'',\n\t\t\t\tselectedOption:'',\n\t\t\t\tselectedCondition:'',\n\t\t\t\tfile: \"\",\n\t\t\t\tboxOne: '',\n\t\t\t\tlastLocationLat:'',\n\t\t\t\tshowAlerts:{\n\t\t\t\t\ttitle:'',\n          show:false,\n          content:'',\n\t\t\t\t\tbuttonText:''\n        },\n        colorList:['Black','White','Silver','Blue','Red','Brown','Gold','Orange','Yellow','Purple','Green','Pink','Others'],\n        conditionList:['New','Used','Demo'],\n\t\t\t\tmap:{},\n\t\t\t\timgData: {\n\t\t\t\t\taccept: \"image/gif, image/jpeg, image/png, image/jpg\"\n\t\t\t\t},\n\t\t\t}\n\t\t},\n\n\t\tmounted() {//初始化各项数据\n\t\t\tlet that = this;\n\t\t\tlet url = 'https://api-saas-qa.zus.ai/api/v1/vehicle/detail/id?vehicleId=' + that.id;\n\t\t\thttpClient.get(url).then((res) => {\n\t\t\t\tlet myData = res.data.data;\n\t\t\t\tthat.image = myData.photoPath;\n\t\t\t\tthat.year = myData.year;\n\t\t\t\tthat.vin = myData.vin;\n\t\t\t\tthat.inventoryTime = myData.inventoryTime;\n\t\t\t\tthat.currentMileage = myData.currentMileage;\n\t\t\t\tthat.lot = myData.parkingLot;\n\t\t\t\tthat.iMei = myData.deviceMac;\n\t\t\t\tthat.price = myData.price;\n\t\t\t\tthat.priceUnit = myData.priceUnit;\n\t\t\t\tthat.color = myData.color;\n\t\t\t\tthat.Odometer = Math.round(myData.currentMileage * 0.0006214);\n\t\t\t\tthat.make = myData.make;\n\t\t\t\tthat.lastLocationLat = myData.lastLocationLat;\n\t\t\t\tthat.modal = myData.model;\n\t\t\t\tthat.trim = myData.trim;\n\t\t\t\tthat.engineType = myData.engineType;\n\t\t\t\tthat.condition = myData.vehicleType;\n\t\t\t\tthat.stockNumber = myData.stockNumber;\n\t\t\t\tthat.plateNumber = myData.plate;\n\t\t\t\tlet _i = that.colorList.findIndex((val)=> val === that.color);\n\t\t\t\tthat.selectedOption = that.colorList[_i];\n\t\t\t\tlet _j = that.conditionList.findIndex((val)=> val === that.condition);\n\t\t\t\tthat.selectedCondition = that.conditionList[_j];\n\t\t\t\tthat.lastLocation = myData.lastLocation;\n\t\t\t\tthat.isOnline = myData.adapter === 'Online' ? 'Online' :'Offline';\n\t\t\t\tmyData.lastUpdateTime !== null ? that.lastUpdateTime = getDateString(myData.lastUpdateTime) : that.lastUpdateTime = 'N/A';\n\t\t\t\tmyData.inventoryTime !== null ? that.inventoryDate = getYMDString(myData.inventoryTime) : '';\n\t\t\t\tthat.map = {\n\t\t\t\t\tlat: myData.lastLocationLat === null ? '' : myData.lastLocationLat,\n\t\t\t\t\tlng: myData.lastLocationLng === null ? '' : myData.lastLocationLng,\n\t\t\t\t\tarea: myData.areaCoordinates === null ? '' : myData.areaCoordinates,\n\t\t\t\t\tvehicleInfo: 'info'\n\t\t\t\t};\n\t\t\t});\n\t\t},\n\t\tmethods: {\n\t\t\tgetFile(event) {//图片上传\n\t\t\t\tthis.file = event.target.files[0];\n\t\t\t\tlet formData = new FormData();\n\t\t\t\tformData.append(\"file\", this.file); //‘file’是後台接收文件名\n\t\t\t\tlet config = {\n\t\t\t\t\theaders: {\n\t\t\t\t\t\t\"Content-Type\": \"multipart/form-data\"\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tlet self = this;\n\t\t\t\thttpClient.post(\"https://api-saas-qa.zus.ai/api/v1/uploadFile\", formData, config)\n\t\t\t\t\t.then(function(res) {\n\t\t\t\t\t\tif(res.data.code === 200){\n\t\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\t\ttitle:'Photo Upload',\n\t\t\t\t\t\t\t\tshow:true,\n\t\t\t\t\t\t\t\tcontent:'Photo Uploaded Successfully',\n\t\t\t\t\t\t\t\tbuttonText:{\n\t\t\t\t\t\t\t\t\tbtnFirst:'',\n\t\t\t\t\t\t\t\t\tbtnSecond:'OK'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.closeRemind(passData);\n            }\n\t\t\t\t\t\tself.image = res.data.data.path;\n\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\tif(err){\n\t\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\t\ttitle:'Photo Upload',\n\t\t\t\t\t\t\t\tshow:true,\n\t\t\t\t\t\t\t\tcontent:'Photo Upload Failed',\n\t\t\t\t\t\t\t\tbuttonText:{\n\t\t\t\t\t\t\t\t\tbtnFirst:'',\n\t\t\t\t\t\t\t\t\tbtnSecond:'OK'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.closeRemind(passData);\n            }\n\t\t\t\t});\n\t\t\t},\n      saveData(){//设备参数更新，保存\n\t\t\t\tlet carType = this.selectedCondition;\n\t\t\t\tif(carType === 'New'){\n\t\t\t\t\tcarType = 1;\n        }else if(carType === 'Used'){\n\t\t\t\t\tcarType = 3;\n        }else{\n\t\t\t\t\tcarType = 2;\n        }\n\t\t\t\tfunction convertDateToTime(strtime) {\n\t\t\t\t\tvar date = new Date(strtime);\n\t\t\t\t\treturn date.getTime();\n\t\t\t\t}\n\t\t\t\tfunction isInteger(obj) {\n\t\t\t\t\treturn typeof obj === 'number' && obj%1 === 0\n\t\t\t\t}\n\n\t\t\t\tlet _time = convertDateToTime(this.inventoryDate);\n\t\t\t\tlet dataTime;\n\t\t\t\tif(_time && isInteger(_time)){\n\t\t\t\t\tdataTime = _time\n        }\n\n\t\t\t\tlet _data = {\n\t\t\t\t\tcolor:this.selectedOption,\n\t\t\t\t\tcurrentMileage:parseInt(this.currentMileage) > 0 ? this.currentMileage*1609.344 :null,\n\t\t\t\t\tengineType:this.engineType,\n\t\t\t\t\tid: this.$router.currentRoute.params.id,\n\t\t\t\t\tinventoryTime: dataTime,\n\t\t\t\t\tmake:this.make,\n\t\t\t\t\tmodel:this.modal,\n\t\t\t\t\tphotoPath: this.image,\n\t\t\t\t\tplat:this.plateNumber,\n\t\t\t\t\tprice:this.price,\n\t\t\t\t\tstockNumber:this.stockNumber,\n\t\t\t\t\ttrim:this.trim,\n\t\t\t\t\tvehicleType:carType,\n\t\t\t\t\tyear:this.year,\n        };\n\n\t\t\t\tlet link = \"https://api-saas-qa.zus.ai/api/v1/vehicle/update\";\n\t\t\t\tlet self = this;\n\t\t\t\thttpClient.post(link, _data).then(function (res) {\n          if(res.data.data && res.data.data.result){\n\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\ttitle:'Vehicle Update',\n              show:true,\n              content:'Success!',\n              buttonText:{\n\t\t\t\t\t\t\t\tbtnFirst:'',\n                btnSecond:'OK'\n              }\n            };\n\t\t\t\t\t\tself.closeRemind(passData);\n          }\n\t\t\t\t\t}).catch(function (err) {\n\t\t\t\t\t\tif(err){\n\t\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\t\ttitle:'Vehicle Update',\n\t\t\t\t\t\t\t\tshow:true,\n\t\t\t\t\t\t\t\tcontent:'Failed!',\n\t\t\t\t\t\t\t\tbuttonText:{\n\t\t\t\t\t\t\t\t\tbtnFirst:'',\n\t\t\t\t\t\t\t\t\tbtnSecond:'OK'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tself.closeRemind(passData);\n            }\n\t\t\t\t\t});\n      },\n      unPairdevice(){//设备解绑，未绑定的设备，按钮不显示\n\t\t\t\tlet link = '/api/v1/vehicle/bind/device';\n\t\t\t\tlet self = this;\n\t\t\t\tlet data = {\n\t\t\t\t\tdeviceMac:this.iMei,\n          vin:this.vin\n        };\n\t\t\t\thttpClient.post(link, data).then(function (res) {\n\t\t\t\t\tif(res.data.code === 200) {\n\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\ttitle: 'Vehicle Unpair',\n\t\t\t\t\t\t\tshow: true,\n\t\t\t\t\t\t\tcontent: 'Success!',\n\t\t\t\t\t\t\tbuttonText: {\n\t\t\t\t\t\t\t\tbtnFirst: '',\n\t\t\t\t\t\t\t\tbtnSecond: 'OK'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself.closeRemind(passData);\n\t\t\t\t\t}\n\t\t\t\t}).catch(function (err) {\n\t\t\t\t\tif(err){\n\t\t\t\t\t\tlet passData = {\n\t\t\t\t\t\t\ttitle: 'Vehicle Unpair',\n\t\t\t\t\t\t\tshow: true,\n\t\t\t\t\t\t\tcontent: 'Failed!',\n\t\t\t\t\t\t\tbuttonText: {\n\t\t\t\t\t\t\t\tbtnFirst: '',\n\t\t\t\t\t\t\t\tbtnSecond: 'OK'\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tself.closeRemind(passData);\n          }\n\t\t\t\t});\n      },\n\t\t\tcloseRemind(data){\n\t\t\t\tthis.showAlerts.show = data.show;\n\t\t\t\tthis.showAlerts.title = data.title;\n\t\t\t\tthis.showAlerts.content = data.content;\n\t\t\t\tthis.showAlerts.buttonText = data.buttonText;\n      },\n\t\t\tcloseBox(){//子组件来请求父组件关闭弹窗\n\t\t\t\tthis.showAlerts.show = !this.showAlerts.show;\n      }\n    }\n\t}\n</script>\n<style lang=\"scss\" scoped>\n  .google-maps{\n    cursor: pointer;\n    color: #63c2de;\n    i{\n      font-size: 20px;\n    }\n  }\n  .online{\n    background: #f86c6b;\n    padding: 0 10px;\n    border-radius: 10px;\n    font-weight: bold;\n  }\n  .specific-data{\n    border: 1px solid #23282c;\n    border-bottom: none;\n    div{\n      padding: 10px;\n      border-bottom: 1px solid #23282c;\n    }\n  }\n</style>"],"sourceRoot":"src/views/dashboard/dashboardMain"}]}