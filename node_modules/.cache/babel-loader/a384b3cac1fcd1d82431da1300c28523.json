{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js!/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/inventory/bindVehicle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/inventory/bindVehicle.vue","mtime":1577153439000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport httpClient from \"@/utils/httpclient\";\nimport VehicleForm from \"@/components/vehicleForm\";\nimport model from \"@/components/model\";\nexport default {\n  name: \"bindVehicle\",\n  inject: [\"reload\"],\n  components: {\n    VehicleForm: VehicleForm,\n    model: model\n  },\n  data: function data() {\n    return {\n      step1: true,\n      step2: false,\n      step3: false,\n      deviceId: null,\n      step1Button: true,\n      imeiIsVaild: false,\n      imeiSuccess: false,\n      imeiDisable: false,\n      step2Button: true,\n      title: '',\n      data1: {},\n      data2: null,\n      showTip: false,\n      vin: '',\n      vinDisable: false,\n      vinIsVaild: false,\n      vinSuccess: false,\n      isClickStep2: false,\n      vehicleId: '',\n      btnGroup: {\n        btnFirst: 'Cancel',\n        btnSecond: 'OK'\n      },\n      content: '',\n      err: false\n    };\n  },\n  watch: {\n    deviceId: function deviceId(newV) {\n      if (newV.length == 15) {\n        this.deviceId = newV;\n        this.imeiDisable = this.err ? false : true;\n        this.imeiIsVaild = false;\n        this.imeiSuccess = true;\n        this.step1Button = false;\n      } else {\n        this.imeiIsVaild = true;\n      }\n    },\n    vin: function vin(newV) {\n      if (newV.length == 17) {\n        this.vin = newV;\n        this.vinDisable = true;\n        this.vinIsVaild = false;\n        this.vinSuccess = false;\n        this.step2Button = false;\n        this.clickStep2();\n      } else {\n        this.vinDisable = false;\n        this.vinIsVaild = true;\n      }\n    }\n  },\n  mounted: function mounted() {\n    if (this.$route.query.deviceMac) {\n      this.step1 = false;\n      this.step2 = true;\n      this.deviceId = this.$route.query.deviceMac;\n    }\n  },\n  methods: {\n    closeBox: function closeBox(type) {\n      if (type && (this.btnGroup.btnSecond == 'Unpair' || this.btnGroup.btnSecond == '解绑')) {\n        this.unbind(this.data1);\n      }\n\n      if (type && this.btnGroup.status == 'vin') {\n        this.unbind(this.data2);\n      }\n\n      this.showTip = false;\n    },\n    reloadPage: function reloadPage() {\n      window.location.reload();\n    },\n    unbind: function unbind(data) {\n      var _this = this;\n\n      httpClient.post('/api/v1/vehicle/unbind/device', {\n        deviceMac: data.deviceMac,\n        vin: data.vin\n      }).then(function (response) {\n        if (response.data.code == 200) {\n          if (_this.step2) {\n            window.location.reload();\n          }\n\n          _this.vin = '';\n          _this.vinDisable = false;\n          _this.vinIsVaild = false;\n          _this.vinSuccess = false;\n          _this.step2Button = true;\n          _this.showTip = false;\n          _this.step1 = false;\n          _this.step2 = true;\n        } else {\n          window.location.reload();\n        }\n      });\n    },\n    clickStep2: function clickStep2() {\n      var _this2 = this;\n\n      httpClient.get('/api/v1/vehicle/detail/vin?vin=' + this.vin, {}).then(function (response) {\n        _this2.data2 = response.data.data;\n        _this2.data2.mac = _this2.deviceId;\n\n        if (_this2.data2.deviceMac == '') {\n          _this2.isClickStep2 = true;\n          _this2.vinSuccess = false;\n        } else {\n          _this2.title = _this2.$t('m.tip.warn');\n          _this2.content = _this2.$t('m.tip.vehicle_pair_warn', {\n            imei: response.data.data.deviceMac\n          });\n          _this2.btnGroup = {\n            btnFirst: _this2.$t('m.tip.b_cancel'),\n            btnSecond: _this2.$t('m.common.b_unpair'),\n            status: 'vin'\n          };\n          _this2.showTip = true;\n          _this2.vinDisable = false;\n        }\n      }).catch(function (err) {\n        _this2.data2 = err.response.data.data;\n        _this2.title = _this2.$t('m.tip.warn');\n        _this2.content = _this2.$t('m.tip.vehicle_pair_warn', {\n          imei: err.response.data.data.deviceMac\n        });\n        _this2.btnGroup = {\n          btnFirst: _this2.$t('m.tip.b_cancel'),\n          btnSecond: _this2.$t('m.common.b_unpair'),\n          status: 'vin'\n        };\n        _this2.showTip = true;\n        _this2.vinDisable = false;\n      });\n    },\n    showStep3: function showStep3(data) {\n      this.step1 = false;\n      this.step2 = false;\n      this.step3 = true;\n      this.vehicleId = data.vehicleId;\n    },\n    clickStep1: function clickStep1() {\n      var _this3 = this;\n\n      httpClient.post('/api/v1/device/vehiceldetail/mac', {\n        deviceMac: this.deviceId\n      }).then(function (response) {\n        _this3.data1 = response.data.data;\n\n        if (_this3.data1.vin == '') {\n          _this3.step1 = false;\n          _this3.step2 = true;\n        } else {\n          _this3.title = _this3.$t('m.tip.warn');\n          _this3.content = _this3.$t('m.tip.vehicle_pair_vin', {\n            year: response.data.data.year,\n            make: response.data.data.make,\n            model: response.data.data.model,\n            vin: response.data.data.vin\n          });\n          _this3.btnGroup = {\n            btnFirst: _this3.$t('m.tip.b_cancel'),\n            btnSecond: _this3.$t('m.common.b_unpair')\n          };\n          _this3.showTip = true;\n        }\n      }).catch(function (err) {\n        if (!err.response.data.data) {\n          _this3.err = true;\n          _this3.imeiDisable = false;\n          _this3.imeiSuccess = false;\n          _this3.title = _this3.$t('m.tip.warn');\n          _this3.content = err.response.data.msg;\n          _this3.btnGroup = {\n            btnSecond: _this3.$t('m.tip.b_ok')\n          };\n          _this3.showTip = true;\n        } else {\n          _this3.data1 = err.response.data.data;\n\n          if (_this3.data1.vin == '') {\n            _this3.step1 = false;\n            _this3.step2 = true;\n          } else {\n            _this3.err = true;\n            _this3.imeiDisable = false;\n            _this3.imeiSuccess = false;\n            _this3.title = _this3.$t('m.tip.warn');\n            _this3.content = _this3.content = _this3.$t('m.tip.vehicle_pair_vin', {\n              year: err.response.data.data.year,\n              make: err.response.data.data.make,\n              model: err.response.data.data.model,\n              vin: err.response.data.data.vin\n            });\n            _this3.btnGroup = {\n              btnFirst: _this3.$t('m.tip.b_cancel'),\n              btnSecond: _this3.$t('m.common.b_unpair')\n            };\n            _this3.showTip = true;\n          }\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["bindVehicle.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n    <div class=\"animated fadeIn bind-vehicle\">\n        <b-card>\n            <div slot=\"header\">\n                {{ $t('m.vehicle_bind.title') }}\n            </div>\n            <div class=\"content\">\n                <b-row class=\"step\">\n                    <b-col sm=\"4\">\n                        <button class=\"btn btn-sm mx-3 px-4 btn-pad\" :class=\"step1 ? 'btn-success' : 'btn-secondary'\">\n                            <strong>{{ $t('m.vehicle_bind.step1') }}</strong><br />\n                            {{ $t('m.vehicle_bind.step1_des') }}\n                        </button>\n                    </b-col>\n                    <b-col sm=\"4\">\n                        <button class=\"btn btn-sm mx-3 px-4\" :class=\"step2 ? 'btn-success' : 'btn-secondary'\">\n                            <strong>{{ $t('m.vehicle_bind.step2') }}</strong><br />\n                            {{ $t('m.vehicle_bind.step2_des') }}\n                        </button>\n                    </b-col>\n                    <b-col sm=\"4\">\n                        <button class=\"btn btn-sm mx-3 px-4\" :class=\"step3 ? 'btn-success btn-sm' : 'btn-secondary'\">\n                            <strong>{{ $t('m.vehicle_bind.step3') }}</strong><br />\n                            {{ $t('m.vehicle_bind.step3_des') }}\n                        </button>\n                    </b-col>\n                </b-row>\n                <div class=\"step-info step1\" v-if=\"step1\">\n                    <b-form-group>\n                        <label>{{ $t('m.vehicle_bind.imei') }}</label>\n                        <b-form-input type=\"text\" v-model=\"deviceId\" :placeholder=\"$t('m.common.enter') + $t('m.vehicle_bind.imei')\" :class=\"imeiIsVaild ? 'is-invalid' : ''\" :disabled=\"imeiDisable\" maxlength=\"15\"></b-form-input>\n                        <p v-show=\"imeiIsVaild\" class=\"warn-imei\">{{ $t('m.common.imei') + $t('m.vehicle_bind.invalid') }}</p>\n                        <p v-show=\"imeiSuccess\" class=\"primary-imei\">{{ $t('m.common.imei') + $t('m.vehicle_bind.valid') }}</p>\n                    </b-form-group>\n                    <div class=\"next-btn\">\n                        <b-button type=\"submit\" :disabled=\"step1Button\" class=\"btn-sm btn-success justify-content-center\" @click=\"clickStep1\">{{ $t('m.vehicle_bind.next') }}</b-button>\n                    </div>\n\n                </div>\n                <div class=\"step-info step2\" v-if=\"step2\">\n                    <b-row>\n                        <b-col sm=\"6\">\n                            <b-form-group>\n                                <label>{{ $t('m.vehicle_bind.imei') }}</label>\n                                <b-form-input type=\"text\" v-model=\"deviceId\" :placeholder=\"$t('m.common.enter') + $t('m.vehicle_bind.imei')\" disabled maxlength=\"15\"></b-form-input>\n                            </b-form-group>\n                        </b-col>\n                        <b-col sm=\"6\">\n                            <b-form-group>\n                                <label>{{ $t('m.common.vin3') }}</label>\n                                <b-form-input type=\"text\" v-model=\"vin\" :placeholder=\"$t('m.common.enter') + $t('m.common.vin3')\" maxlength=\"17\" :class=\"vinIsVaild ? 'is-invalid' : ''\" :disabled=\"vinDisable\"></b-form-input>\n                                <p v-show=\"vinIsVaild\" class=\"warn-imei\">{{ $t('m.common.vin3') + $t('m.vehicle_bind.invalid') }}</p>\n                                <p v-show=\"vinSuccess\" class=\"primary-imei\">{{  $t('m.common.vin3') + $t('m.vehicle_bind.valid') }}</p>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <vehicle-form\n                            v-if=\"isClickStep2\"\n                            :vehicleInfo=\"data2\"\n                            @showStep3=\"showStep3\"\n                    >\n                    </vehicle-form>\n                    <div class=\"text-center\" v-if=\"!isClickStep2\">\n                        <b-button type=\"submit\" :disabled=\"step2Button\" class=\"btn-sm btn-success\">{{ $t('m.common.submit') }}</b-button>\n                    </div>\n                </div>\n                <div class=\"step-info step3\" v-if=\"step3\">\n                    <b-row class=\"justify-content-center\">\n                        <span class=\"font-144\">\n                            <i class=\"cui cui-check\"></i>\n                        </span>\n                    </b-row>\n                    <p class=\"text-center\">{{ $t('m.vehicle_bind.install_completed') }}</p>\n                    <b-row class=\"justify-content-center\">\n                        <b-col sm=\"4\" md=\"4\" xs=\"12\">\n                            <button class=\"btn btn-block btn-outline-success\" @click=\"$router.push('/index')\">{{ $t('m.vehicle_bind.dashboard') }}</button>\n                        </b-col>\n                        <b-col sm=\"4\" md=\"4\" xs=\"12\">\n                            <button class=\"btn btn-block btn-outline-success\" @click=\"reloadPage()\">{{ $t('m.vehicle_bind.continue') }}</button>\n                        </b-col>\n                        <b-col sm=\"4\" md=\"4\" xs=\"12\">\n                            <button class=\"btn btn-block btn-outline-success\" @click=\"$router.push('/inventory/vehicle/detail/' + vehicleId)\">{{ $t('m.vehicle_bind.detail') }}</button>\n                        </b-col>\n                    </b-row>\n                </div>\n            </div>\n        </b-card>\n        <model\n                :show=\"showTip\"\n                :title=\"title\"\n                :content=\"content\"\n                :buttonText=\"btnGroup\"\n                @closeRemindBox=\"closeBox\"\n        ></model>\n    </div>\n</template>\n\n<script>\n    import httpClient from \"@/utils/httpclient\";\n    import VehicleForm from \"@/components/vehicleForm\";\n    import model from \"@/components/model\";\n    export default {\n        name: \"bindVehicle\",\n        inject: [\"reload\"],\n        components: {\n            VehicleForm,\n            model\n        },\n        data() {\n            return {\n                step1: true,\n                step2: false,\n                step3: false,\n                deviceId: null,\n                step1Button: true,\n                imeiIsVaild: false,\n                imeiSuccess: false,\n                imeiDisable: false,\n                step2Button: true,\n                title: '',\n                data1: {},\n                data2: null,\n                showTip: false,\n                vin: '',\n                vinDisable: false,\n                vinIsVaild: false,\n                vinSuccess: false,\n                isClickStep2: false,\n                vehicleId: '',\n                btnGroup: {btnFirst:'Cancel', btnSecond: 'OK'},\n                content: '',\n                err: false\n            }\n        },\n        watch: {\n            deviceId(newV) {\n                if (newV.length == 15) {\n                    this.deviceId = newV;\n                    this.imeiDisable = this.err ? false : true;\n                    this.imeiIsVaild = false;\n                    this.imeiSuccess = true;\n                    this.step1Button = false;\n                } else {\n                    this.imeiIsVaild = true;\n                }\n            },\n            vin(newV) {\n                if (newV.length == 17) {\n                    this.vin = newV;\n                    this.vinDisable = true;\n                    this.vinIsVaild = false;\n                    this.vinSuccess = false;\n                    this.step2Button = false;\n                    this.clickStep2();\n                } else {\n                    this.vinDisable = false;\n                    this.vinIsVaild = true;\n\n                }\n            }\n        },\n        mounted() {\n            if (this.$route.query.deviceMac) {\n                this.step1 = false;\n                this.step2 = true;\n                this.deviceId = this.$route.query.deviceMac;\n            }\n        },\n        methods: {\n            closeBox(type){\n                if (type && (this.btnGroup.btnSecond == 'Unpair' || this.btnGroup.btnSecond == '解绑')) {\n                    this.unbind(this.data1);\n                }\n                if (type && this.btnGroup.status == 'vin') {\n                    this.unbind(this.data2);\n                }\n                this.showTip = false;\n            },\n            reloadPage() {\n                window.location.reload();\n            },\n            unbind(data) {\n                httpClient.post('/api/v1/vehicle/unbind/device', {\n                    deviceMac: data.deviceMac,\n                    vin: data.vin\n                }).then(response => {\n                    if (response.data.code == 200) {\n                        if (this.step2) {\n                            window.location.reload();\n                        }\n                        this.vin = '';\n                        this.vinDisable = false;\n                        this.vinIsVaild = false;\n                        this.vinSuccess = false;\n                        this.step2Button = true;\n                        this.showTip = false;\n                        this.step1 = false;\n                        this.step2 = true;\n                    } else {\n                        window.location.reload();\n                    }\n                })\n            },\n            clickStep2() {\n                httpClient.get('/api/v1/vehicle/detail/vin?vin=' + this.vin, {\n                }).then(response => {\n                    this.data2 = response.data.data;\n                    this.data2.mac = this.deviceId;\n                    if (this.data2.deviceMac == '') {\n                        this.isClickStep2 = true;\n                        this.vinSuccess = false;\n                    } else {\n                        this.title = this.$t('m.tip.warn');\n                        this.content = this.$t('m.tip.vehicle_pair_warn', {imei: response.data.data.deviceMac});\n                        this.btnGroup = {btnFirst:this.$t('m.tip.b_cancel'), btnSecond: this.$t('m.common.b_unpair'), status: 'vin'};\n                        this.showTip = true;\n                        this.vinDisable = false;\n                    }\n                }).catch(err => {\n                    this.data2 = err.response.data.data;\n                    this.title = this.$t('m.tip.warn');\n                    this.content = this.$t('m.tip.vehicle_pair_warn', {imei: err.response.data.data.deviceMac});\n                    this.btnGroup = {btnFirst:this.$t('m.tip.b_cancel'), btnSecond: this.$t('m.common.b_unpair'), status: 'vin'};\n                    this.showTip = true;\n                    this.vinDisable = false;\n                })\n            },\n            showStep3(data) {\n                this.step1 = false;\n                this.step2 = false;\n                this.step3 = true;\n                this.vehicleId = data.vehicleId;\n            },\n            clickStep1() {\n                httpClient.post('/api/v1/device/vehiceldetail/mac', {\n                    deviceMac: this.deviceId\n                }).then(response => {\n                    this.data1 = response.data.data;\n                    if (this.data1.vin == ''){\n                        this.step1 = false;\n                        this.step2 = true;\n                    } else {\n                        this.title = this.$t('m.tip.warn');\n                        this.content = this.$t('m.tip.vehicle_pair_vin', {year: response.data.data.year, make: response.data.data.make, model: response.data.data.model, vin: response.data.data.vin})\n                        this.btnGroup = {btnFirst:this.$t('m.tip.b_cancel'), btnSecond: this.$t('m.common.b_unpair')};\n                        this.showTip = true;\n                    }\n                }).catch(err => {\n                    if (!err.response.data.data) {\n                        this.err = true;\n                        this.imeiDisable = false;\n                        this.imeiSuccess = false;\n                        this.title = this.$t('m.tip.warn');\n                        this.content = err.response.data.msg;\n                        this.btnGroup = {btnSecond: this.$t('m.tip.b_ok')};\n                        this.showTip = true;\n                    } else {\n                        this.data1 = err.response.data.data;\n                        if (this.data1.vin == ''){\n                            this.step1 = false;\n                            this.step2 = true;\n                        } else {\n                            this.err = true;\n                            this.imeiDisable = false;\n                            this.imeiSuccess = false;\n                            this.title = this.$t('m.tip.warn');\n                            this.content = this.content = this.$t('m.tip.vehicle_pair_vin', {year: err.response.data.data.year, make: err.response.data.data.make, model: err.response.data.data.model, vin: err.response.data.data.vin})\n                            this.btnGroup = {btnFirst:this.$t('m.tip.b_cancel'), btnSecond: this.$t('m.common.b_unpair')};\n                            this.showTip = true;\n                        }\n                    }\n                })\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .bind-vehicle {\n        .modal {\n            .modal-footer {\n                border-top: 0;\n            }\n        }\n        .font-144 {\n            font-size: 144px;\n        }\n        .content {\n            max-width: 660px;\n            margin: 0 auto;\n            .step {\n                .btn-pad {\n                    padding-left: 0px;\n                    padding-right: 0px;\n                }\n                button {\n                    width: 100%;\n                }\n                button:first-child {\n                    margin-left: 0 !important;\n                }\n            }\n            .step1 {\n                max-width: 300px;\n                margin: 10% auto 0;\n                display: flex;\n                flex-direction: column;\n                justify-content: center;\n                .next-btn{\n                    display: flex;\n                    justify-content: center;\n                    margin-bottom: 5px;\n                }\n                input {\n                    max-width: 300px;\n                }\n            }\n            .step2 {\n                margin-top: 6%;\n                .row {\n                    margin-left: 0px!important;\n                }\n                button {\n                    margin-left: 15px;\n                }\n            }\n            .warn-imei {\n                color: #f86c6b;\n                font-size: 12px;\n                margin-top: 4px;\n            }\n            .primary-imei {\n                color: #4dbd74;\n                font-size: 12px;\n                margin-top: 4px;\n            }\n        }\n    }\n</style>\n\n"],"sourceRoot":"src/views/dashboard/inventory"}]}