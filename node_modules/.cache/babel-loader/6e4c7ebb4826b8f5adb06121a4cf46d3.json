{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js!/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js!/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicleDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicleDetail.vue","mtime":1569469227000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport httpclient from '@/utils/httpclient';\nimport { getDateString as _getDateString, getDaysBetweenDate as _getDaysBetweenDate } from \"@/utils/date\";\nimport myMap from '@/components/map';\nexport default {\n  name: \"vehicleDetail\",\n  components: {\n    myMap: myMap\n  },\n  data: function data() {\n    return {\n      btnGroup: {\n        btnFirst: \"Cancel\",\n        btnSecond: 'OK'\n      },\n      data: {},\n      showMap: false,\n      map: null,\n      searchGoogleMap: {},\n      mapPopup: null,\n      tipTitle: '',\n      showSoldVehicle: false,\n      soldVehicleStatus: false,\n      soldVehicleSuccess: false,\n      soldVehicleTransform: false,\n      installDeviceStatus: false,\n      installSuccess: false,\n      installStatus: false,\n      inputText: '',\n      soldVehicleContent: '',\n      soldVehicleHeader: '',\n      transferStatus: false,\n      transferContents: '',\n      transferTitle: '',\n      soldStatus: \"\",\n      soldOutC: \"\",\n      fields: {\n        operation: {\n          key: 'operationType',\n          label: this.$t('m.vehicle_detail.operation')\n        },\n        vehicle: {\n          key: 'vehicle',\n          label: this.$t('m.vehicle_detail.operator')\n        },\n        time: {\n          key: 'time',\n          label: this.$t('m.common.time')\n        }\n      },\n      options: [],\n      selected: null,\n      items: [],\n      totalPages: 1,\n      currentPage: 1,\n      perPage: 10,\n      rows: 1,\n      myCurrentMileage: null\n    };\n  },\n  mounted: function mounted() {\n    if (this.$i18n.locale === 'en-US') {\n      this.changedLanguage = \"English\";\n    } else {\n      this.changedLanguage = 'Chinese';\n    }\n\n    var self = this;\n    httpclient.get(\"/api/v1/vehicle/detail/id?vehicleId=\" + this.$route.params.id, {}).then(function (response) {\n      self.data = response.data.data;\n      var year = self.data.year ? self.data.year : 'N/A';\n      var make = self.data.make ? self.data.make : 'N/A';\n      var model = self.data.model ? self.data.model : 'N/A';\n      var info = year == 'N/A' && make == 'N/A' && model == 'N/A' ? 'N/A' : year + ' ' + make + ' ' + model;\n      self.tipTitle = info;\n      self.map = {\n        lat: self.data.lastLocationLat ? self.data.lastLocationLat : 0,\n        lng: self.data.lastLocationLng ? self.data.lastLocationLng : 0,\n        area: self.data.areaCoordinates ? self.data.areaCoordinates : [],\n        vehicleInfo: info\n      };\n      self.mapPopup = {\n        lat: self.data.lastLocationLat ? self.data.lastLocationLat : 0,\n        lng: self.data.lastLocationLng ? self.data.lastLocationLng : 0,\n        area: self.data.areaCoordinates ? self.data.areaCoordinates : [],\n        vehicleInfo: info\n      };\n      var _mileage = null;\n\n      if (response.data.data.currentMileage) {\n        if (self.changedLanguage === 'English') {\n          _mileage = (response.data.data.currentMileage * 0.0006214).toFixed(0);\n        } else {\n          _mileage = (response.data.data.currentMileage / 1000).toFixed(0);\n        }\n      } else {\n        _mileage = 'N/A';\n      }\n\n      self.myCurrentMileage = _mileage;\n    }).catch(function (err) {\n      console.log(err);\n    });\n    this.getVehicleOperatorList(1);\n  },\n  methods: {\n    getDateString: function getDateString(data) {\n      return _getDateString(data);\n    },\n    getDaysBetweenDate: function getDaysBetweenDate(data, time) {\n      return _getDaysBetweenDate(data, time);\n    },\n    getVehicleOperatorList: function getVehicleOperatorList(page) {\n      var _this = this;\n\n      var myVehicleId = this.$route.params.id;\n      var myLink = '/api/v1/operationlog/listbyvehicleid?pageNo=' + page + '&vehicleId=' + myVehicleId;\n      httpclient.get(myLink).then(function (res) {\n        var myData = res.data.data.datas;\n        _this.items = myData;\n        _this.searchGoogleMap = myData; // this.currentPage = res.data.data.pageNo;\n\n        _this.perPage = res.data.data.pageSize;\n        _this.totalPages = res.data.data.totalPages;\n        _this.rows = res.data.data.rowCount;\n        var myArr = [];\n        myData.map(function (item) {\n          myArr.push({\n            operationType: item.operationType,\n            operator: item.userName,\n            time: _this.getDateString(item.createTime),\n            userId: item.userId\n          });\n        });\n        _this.items = myArr;\n      });\n    },\n    turnToPage: function turnToPage(p) {\n      this.getVehicleOperatorList(p ? p : 1);\n    },\n    showMapTip: function showMapTip() {\n      this.showMap = true;\n    },\n    showRegisterSold: function showRegisterSold() {\n      this.soldOutC = this.$t('m.sold_vehicle.sold_content', {\n        year: this.data.year ? this.data.year : 'N/A',\n        make: this.data.make ? this.data.make : 'N/A',\n        model: this.data.model ? this.data.model : 'N/A',\n        alias: this.data.alias ? this.data.alias : 'N/A',\n        stock: this.data.stockNumber ? this.data.stockNumber : 'N/A'\n      });\n      this.showSoldVehicle = true;\n    },\n    registerSold: function registerSold() {\n      var _this2 = this;\n\n      //确认登记售出\n      var vehicleId = this.$route.params.id;\n      httpclient.post('/api/v1/vehicle/sale', {\n        \"vehicleId\": vehicleId\n      }).then(function (res) {\n        if (res.data.code === 200 && res.data.data.result) {\n          _this2.soldVehicleSuccess = true;\n          _this2.soldVehicleStatus = true;\n          _this2.data.soldVehicleContent = _this2.$t('m.sold_vehicle.sold_content_success', {\n            year: _this2.data.year ? _this2.data.year : 'N/A',\n            make: _this2.data.make ? _this2.data.make : 'N/A',\n            model: _this2.data.model ? _this2.data.model : 'N/A',\n            alias: _this2.data.alias ? _this2.data.alias : 'N/A',\n            stock: _this2.data.stockNumber ? _this2.data.stockNumber : 'N/A'\n          });\n          _this2.data.soldVehicleHeader = _this2.$t('m.sold_vehicle.sold_header_success');\n        } else {\n          _this2.soldVehicleSuccess = false;\n          _this2.soldVehicleStatus = true;\n          _this2.data.soldVehicleContent = _this2.$t('m.sold_vehicle.sold_content_fail', {\n            year: _this2.data.year ? _this2.data.year : 'N/A',\n            make: _this2.data.make ? _this2.data.make : 'N/A',\n            model: _this2.data.model ? _this2.data.model : 'N/A',\n            alias: _this2.data.alias ? _this2.data.alias : 'N/A',\n            stock: _this2.data.stockNumber ? _this2.data.stockNumber : 'N/A'\n          });\n          _this2.data.soldVehicleHeader = _this2.$t('m.sold_vehicle.sold_header_fail');\n        }\n      });\n    },\n    goBackToList: function goBackToList() {\n      //回到列表\n      if (this.soldVehicleSuccess) {\n        this.$router.push('/inventory/vehicle');\n      }\n    },\n    confirmTransformVehicle: function confirmTransformVehicle() {\n      var _this3 = this;\n\n      //车辆转移确认\n      if (this.selected !== null) {\n        var _name = '';\n        this.options.map(function (item) {\n          if (item.value === _this3.selected) {\n            _name = item.text;\n          }\n        });\n        var data = {\n          \"vehicleId\": this.$route.params.id,\n          \"transferStoreId\": this.selected\n        };\n        httpclient.post('/api/v1/vehicle/transfer', data).then(function (res) {\n          _this3.transferStatus = true;\n\n          if (res.data.code === 200 && res.data.data.result === true) {\n            _this3.transferTitle = _this3.$t('m.sold_vehicle.transform_vehicle_to_other_store_header_success');\n            _this3.transferContents = _this3.$t('m.sold_vehicle.transform_vehicle_to_other_store_content_success', {\n              year: _this3.data.year ? _this3.data.year : 'N/A',\n              make: _this3.data.make ? _this3.data.make : 'N/A',\n              model: _this3.data.model ? _this3.data.model : 'N/A',\n              alias: _this3.data.alias ? _this3.data.alias : 'N/A',\n              storeName: _name,\n              stock: _this3.data.stockNumber ? _this3.data.stockNumber : 'N/A'\n            });\n          } else {\n            _this3.transferTitle = _this3.$t('m.sold_vehicle.transform_vehicle_to_other_store_header_fail');\n            _this3.transferContents = _this3.$t('m.sold_vehicle.transform_vehicle_to_other_store_content_fail');\n          }\n        });\n      }\n    },\n    showTransformVehicle: function showTransformVehicle() {\n      var _this4 = this;\n\n      //弹出车辆转移的弹窗，获取门店列表\n      this.soldVehicleTransform = true;\n      httpclient.get('/api/v1/store/listbyself?vehicleid=' + this.$route.params.id).then(function (res) {\n        if (res.data.code === 200 && res.data.data.length) {\n          _this4.options.length = 0;\n\n          _this4.options.push({\n            value: null,\n            text: _this4.$t('m.sold_vehicle.transform_vehicle_to_other_store_options'),\n            disabled: true\n          });\n\n          res.data.data.map(function (item) {\n            _this4.options.push({\n              value: item.storeId,\n              text: item.storeName\n            });\n          });\n        }\n      });\n    },\n    afterTransfer: function afterTransfer() {\n      //转移成功，跳转到vehicle-list\n      if (this.transferStatus) {\n        this.$router.push('/inventory/vehicle');\n      }\n    },\n    showBindInfo: function showBindInfo() {\n      this.installDeviceStatus = !this.installDeviceStatus;\n    },\n    installDevice: function installDevice() {\n      var _this5 = this;\n\n      httpclient.post('/api/v1/clouddrive/device/box/bind', {\n        deviceImei: this.inputText,\n        vehicleId: this.$route.params.id\n      }).then(function (res) {\n        if (res.data.code === 200 && res.data.data.result) {\n          _this5.installStatus = true;\n          _this5.installSuccess = true;\n        } else {\n          _this5.installStatus = false;\n          _this5.installSuccess = true;\n        }\n      });\n    }\n  }\n};",null]}