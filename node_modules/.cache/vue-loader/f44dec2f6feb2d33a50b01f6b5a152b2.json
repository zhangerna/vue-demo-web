{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue?vue&type=style&index=0&id=d74a34b6&lang=scss&scoped=true&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue","mtime":1561360764000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/sass-loader/lib/loader.js","mtime":1533139052000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.top-holder {\n    margin-top: 12px;\n}\n.filter-left{\n    .card-body{\n        padding-left: 0;\n    }\n    .text-primary{\n        padding-left: 0;\n    }\n    .col-sm-10{\n        padding-left: 0;\n    }\n}\n.vehicle {\n    width: 100%;\n\n    .link-to-detail {\n        cursor: pointer;\n        color: #20a8d8;\n\n        &:hover {\n            text-decoration: underline;\n        }\n    }\n\n    .search-group {\n        width: 40%;\n        margin-top: 2%;\n        display: inline-block;\n\n        input {\n            height: 40px;\n        }\n\n        button {\n            margin-left: 0px;\n            height: 36px;\n        }\n\n        a {\n            margin-left: 10%;\n        }\n    }\n\n    i {\n        margin-right: 4px;\n    }\n\n    .collapse-m {\n        border-color: #1FA8D8;\n        border-style: dashed;\n    }\n\n    .table-outline {\n        margin-top: 2%;\n    }\n\n    .filter-content {\n        display: inline-block;\n    }\n\n    .header-right {\n        float: right;\n\n        button {\n            background-color: #20a8d8 !important;\n            border-color: #20a8d8 !important;\n        }\n    }\n}\n\n.btn {\n    margin: 2px;\n}\n\n.mapLocation {\n\n}\n\n.photo-url {\n    img {\n        border-radius: 4px;\n    }\n\n    span {\n        position: absolute;\n        background-color: #73818f;\n        border-radius: 4px;\n        padding: 0.25rem;\n        font-size: 12px;\n    }\n\n    strong {\n\n    }\n}\n",{"version":3,"sources":["vehicle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8XA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA","file":"vehicle.vue","sourceRoot":"src/views/dashboard/dashboardMain","sourcesContent":["<template>\n    <div class=\"animated fadeIn vehicle\">\n        <b-card style=\"width: 100%;\">\n            <div slot=\"header\">\n                <i class='fa fa-automobile'></i>\n                <span>Vehicles</span>\n                <div class=\"header-right\">\n                    <b-button class=\"btn btn-sm btn-primary mr-2\" @click=\"$router.push('/vehicle/add')\">\n                        <i class=\"fa fa-plus-square\"></i>\n                        Add Inventory\n                    </b-button>\n                    <b-button class=\"btn btn-sm btn-primary mr-2\" @click=\"$router.push('/vehicle/bind')\">\n                        <i class=\"fa fa-wrench\"></i>\n                        Device Installation\n                    </b-button>\n                </div>\n            </div>\n            <div>\n                <b-form-group label-for=\"elementsAppendButton\" class=\"search-group\">\n                    <b-input-group>\n                        <b-form-input type=\"text\" v-model=\"search\"></b-form-input>\n                        <b-input-group-append>\n                            <b-button variant=\"primary\" @click=\"searchData\"><i class=\"fa fa-search\"></i>Search\n                            </b-button>\n                        </b-input-group-append>\n                    </b-input-group>\n                </b-form-group>\n\n                <b-btn v-b-toggle.collapse class=\"m-1 btn btn-outline-info\">\n                    <i class=\"fa fa-filter\"></i>Filters\n                </b-btn>\n            </div>\n            <b-collapse id=\"collapse\">\n                <b-card class=\"collapse-m filter-left\" style=\"width: 100%\">\n                    <template v-for=\"item in gFData\">\n                        <b-row :key=\"item.label\">\n                            <b-col sm=\"2\" class=\"text-primary\">\n                                <strong>{{ item.label }}</strong>\n                            </b-col>\n                            <b-col sm=\"10\">\n                                <div v-for=\"it in item.filters\" :key=\"it.value\" class=\"filter-content\">\n                                    <b-form-checkbox-group v-model=\"queryData[item.key]\">\n                                        <b-form-checkbox :value=\"it.value\" :name=\"item.key\" ref=\"checkbox\"\n                                                         :checked=\"queryData[item.key]\">\n                                            {{ it.key }}\n                                        </b-form-checkbox>\n                                    </b-form-checkbox-group>\n                                </div>\n                            </b-col>\n                        </b-row>\n                    </template>\n                </b-card>\n            </b-collapse>\n            <b-table class=\"mb-0 table-outline\" small striped responsive=\"sm\" :items=\"table\" hover :fields=\"tableFields\"\n                     head-variant=\"light\">\n                <template slot=\"photoUrl\" slot-scope=\"data\">\n                    <div class=\"photo-url\" @click=\"$router.push('/vehicle/detail/' + data.item.vehicleId)\">\n                        <span>{{ data.item.unboundStatus }}</span>\n                        <img :src=\"data.item.photoUrl\" style=\"object-fit: cover;\" width=\"100px\" height=\"100px\">\n                    </div>\n                </template>\n                <template slot=\"battery\" slot-scope=\"data\">\n                    <span class=\"badge badge-pill\" :class=\"data.item.batteryClass ? data.item.batteryClass : '' \">{{ data.item.battery }}</span>\n                </template>\n                <template slot=\"vehicle\" slot-scope=\"data\">\n                    <div>\n                        <div @click=\"$router.push(`/vehicle/detail/${data.item.vehicleId}`)\"><strong\n                            class=\"link-to-detail\">{{data.item.vehicle}}</strong></div>\n                        <div>{{data.item.colorTrim}}</div>\n                        <div>{{data.item.stock}}</div>\n                    </div>\n                </template>\n                <template slot=\"online\" slot-scope=\"data\">\n                    <span class=\"badge badge-pill\"\n                          :class=\"data.item.online == 'Online' ? 'badge-success' : 'btn-secondary' \">{{ data.item.online }}</span>\n                </template>\n                <template slot=\"use\" slot-scope=\"data\">\n                    <span class=\"badge badge-pill\"\n                          :class=\"data.item.use == 'Available' ? 'badge-success' : 'btn-danger' \">{{ data.item.use }}</span>\n                </template>\n                <template slot=\"action\" slot-scope=\"data\">\n                    <div class=\"mapLocation\"\n                         @click=\"showMapTip(data.item.lat, data.item.lng, data.item.area, data.item.info)\"><i\n                        class=\"cui cui-location-pin btn btn-sm btn-secondary\"\n                        :class=\"data.item.lat || data.item.area ? 'btn-success' : '' \"></i></div>\n                    <div class=\"btn btn-sm btn-info vehicledetail\"\n                         @click=\"$router.push('/vehicle/detail/' + data.item.vehicleId)\"><i class=\"fa fa-eye\"></i></div>\n                    <div class=\"btn btn-sm btn-info vehicleedit\"\n                         @click=\"$router.push('/vehicle/edit/' + data.item.vehicleId)\"><i class=\"fa fa-edit\"></i></div>\n                    <div v-b-modal.del-1 class=\"btn btn-sm btn-danger btn-del\" @click=\"delData(data.item.vehicleId)\"><i\n                        class=\"cui cui-trash\"></i></div>\n                </template>\n            </b-table>\n\n            <b-row class=\"top-holder\">\n                <b-col sm=\"4\" lg=\"4\">\n                    <div class=\"dataTables_info\" id=\"DataTables0\" role=\"status\" aria-live=\"polite\">\n\t\t\t\t\t\t<span v-if=\"total > 0\">\n\t\t\t\t\t\t\tShowing {{10 * (currentPage - 1) + 1 }} to {{currentPage === pageCount? total :currentPage * 10 }} of {{total}} entries\n\t\t\t\t\t\t</span>\n                        <span v-else>\n\t\t\t\t\t\t\tShowing 0 to 0 of {{total}} entries\n\t\t\t\t\t\t</span>\n                    </div>\n                </b-col>\n                <b-col sm=\"8\" lg=\"8\">\n                    <b-pagination align=\"right\" :total-rows=\"total\" v-model=\"currentPage\" :per-page=\"perPage\"\n                                  @input=\" changePage(currentPage)\"></b-pagination>\n                </b-col>\n            </b-row>\n\n\n        </b-card>\n        <div class=\"del-tip\">\n            <b-modal ref=\"my-modal\" hide-footer title=\"Are you sure to delete the vehicles?\" v-model=\"showDelMap\"\n                     @ok=\"showDelMap = false\">\n                <b-button @click=\"hideModal\">Cancel</b-button>\n                <button class=\"btn btn-primary\" @click=\"apiDel\">OK</button>\n            </b-modal>\n        </div>\n\n        <b-modal ref=\"my-modal\" v-model=\"showMap\" @ok=\"showMap = false\">\n            <google-map\n                :map=\"map\"\n            ></google-map>\n        </b-modal>\n\n        <b-modal ref=\"my-modal\" v-model=\"showEtip\" @ok=\"showEtip = false\">\n            <b-button>Cancel</b-button>\n            <button class=\"btn btn-primary\">Ok</button>\n        </b-modal>\n    </div>\n</template>\n\n<script>\n    import httpclient from '@/utils/httpclient';\n    import googleMap from '@components/googleMap'\n\n    export default {\n        name: \"vehicle\",\n        components: {\n            googleMap\n        },\n        inject: [\"reload\"],\n        data() {\n            return {\n                tableFields: {\n                    photoUrl: {\n                        label: 'Photo',\n                        class: 'text-center'\n                    },\n                    vehicle: {\n                        label: 'Vehicle',\n                        class: 'text-center'\n                    },\n                    park: {\n                        label: 'Lot',\n                        class: 'text-center'\n                    },\n                    battery: {\n                        label: 'Voltage',\n                        class: 'text-center'\n                    },\n                    online: {\n                        label: 'Online/Offline',\n                        class: 'text-center'\n                    },\n                    use: {\n                        label: 'Available/In Use',\n                        class: 'text-center'\n                    },\n                    price: {\n                        label: 'Price',\n                        class: 'text-center'\n                    },\n                    mileage: {\n                        label: 'Mileage',\n                        class: 'text-center'\n                    },\n                    inventory: {\n                        label: 'Inventory Age',\n                        class: 'text-center'\n                    },\n                    daysIdle: {\n                        label: 'Days Idle',\n                        class: 'text-center'\n                    },\n                    action: {\n                        label: 'Actions',\n                        class: 'text-center'\n                    }\n                },\n                data: null,\n                table: null,\n                showMap: false,\n                map: {},\n                rows: 0,\n                currentPage: 1,\n                total: 0,\n                perPage: 10,\n                showDelMap: false,\n                delId: '',\n                showEtip: false,\n                pageCount: 0,\n                gFData: [],\n                search: '',\n                queryData: {},\n            }\n        },\n        mounted() {\n            let self = this;\n            this.axiosApi(self, 1, this.$route.query.filters ? JSON.parse(this.$route.query.filters) : []);\n            this.getFilter();\n            //初始化checkbox勾选\n            let myData = this.$route.query.filters ? JSON.parse(this.$route.query.filters) : [];\n            if (myData.length) {\n                myData.map((item) => {\n                    this.queryData[item.key] = item.value;\n                })\n            }\n\n        },\n        methods: {\n            getFilter() {\n                httpclient.post('/api/v1/vehiclesearch/filter').then(response => {\n                    this.gFData = response.data.data;\n                }).catch(() => {\n                });\n            },\n            searchData() {\n                let search = [];\n                let keys = [];\n                this.$refs.checkbox.forEach((item) => {\n                    if (item.is_Checked) {\n                        if (keys.includes(item.name)) {\n                            for (let it of search) {\n                                if (it.key == item.name) it.value.push(item.value);\n                            }\n                        } else {\n                            search.push({\n                                key: item.name,\n                                value: [item.value]\n                            });\n                            keys.push(item.name)\n                        }\n                    }\n                });\n                this.axiosApi(this, 1, search);\n\n            },\n            axiosApi(self, page, obj) {\n                httpclient.post(`/api/v1/vehiclesearch/searchnew?searchText=${this.search}&source=&pageNo=${page}&pageSize=10`, {\n                    filters: obj\n                }).then((response) => {\n                    self.data = response.data.data;\n                    self.total = response.data.data.rowCount ? response.data.data.rowCount : 0;\n                    self.currentPage = response.data.data.pageNo ? response.data.data.pageNo : 0;\n                    self.pageCount = response.data.data.pageCount ? response.data.data.pageCount : 0;\n                    this.filterData(self.data.vehicles);\n                }).catch((err) => {\n                    alert(err)\n                })\n            },\n            formatNumber(nStr) {\n                nStr += '';\n                let x = nStr.split('.');\n                let x1 = x[0];\n                let x2 = x.length > 1 ? '.' + x[1] : '';\n                var rgx = /(\\d+)(\\d{3})/;\n                while (rgx.test(x1)) {\n                    x1 = x1.replace(rgx, '$1' + ',' + '$2');\n                }\n                return x1 + x2;\n            },\n            changePage(page) {\n                let self = this;\n                this.axiosApi(self, page, []);\n            },\n            apiDel() {\n                httpclient.post('/api/v1/vehicle/delete', {\n                    vehicleId: this.delId\n                }).then(response => {\n                    if (response.data.code == 200) {\n                        this.reload();\n                        this.showDelMap = !this.showDelMap\n                    } else {\n                        this.showEtip = true;\n                    }\n                }).catch(() => {\n                    this.showEtip = true;\n                })\n            },\n            showMapTip(lat, lng, area, info) {\n                if (lat || area) {\n                    this.map = {\n                        lat: lat,\n                        lng: lng,\n                        area: area,\n                        vehicleInfo: info\n                    };\n                    this.showMap = true;\n                }\n            },\n            format_number(nStr) {\n                nStr += '';\n                let x = nStr.split('.');\n                let x1 = x[0];\n                let x2 = x.length > 1 ? '.' + x[1] : '';\n                var rgx = /(\\d+)(\\d{3})/;\n                while (rgx.test(x1)) {\n                    x1 = x1.replace(rgx, '$1' + ',' + '$2');\n                }\n                return x1 + x2;\n            },\n            hideModal() {\n                // this.$refs['my-modal'].hide();\n                this.showDelMap = !this.showDelMap\n            },\n            delData(id) {\n                this.delId = id;\n                this.showDelMap = true;\n            },\n            filterData(data) {\n                let self = this;\n                this.table = data.map(function (item) {\n                    let pack;\n                    if(item.outStatus ===1){\n                        pack = item.parkingName\n                    }else if(item.outStatus ===2){\n                        pack = item.parkingName ? 'Off Lot' : 'N/A'\n                    }else{\n                        pack = 'N/A'\n                    }\n\n                    let battery = null;\n                    let batteryClass = null;\n                    if (item.currentVoltage) {\n                        let numBat = item.currentVoltage.toFixed(1);\n                        battery = item.currentVoltage.toFixed(1) + ' V';\n                        batteryClass = numBat <= 11.7 ? 'badge-danger' : (numBat > 11.7 && numBat <= 12.1 ? 'badge-warning' : 'badge-success');\n                    } else {\n                        battery = \"N/A\";\n                        batteryClass = 'badge-secondary';\n                    }\n                    let onlineStatus = item.isOnline == 1 ? \"Online\" : \"Offline\";\n                    let year = item.year ? item.year : 'N/A';\n                    let make = item.make ? item.make : 'N/A';\n                    let model = item.model ? item.model : 'N/A';\n                    let info = (year == 'N/A' && make == 'N/A' && model == 'N/A') ? 'N/A' : year + ' ' + make + ' ' + model;\n                    let color = item.color ? item.color : 'N/A';\n                    let trim = item.trim ? item.trim : 'N/A';\n                    let colorTrim = (color == 'N/A' && trim == 'N/A') ? 'N/A' : color + ' , ' + trim;\n                    return {\n                        \"photoUrl\": item.photoUrl ? item.photoUrl : require(\"@/assets/pages-img/placeholder.svg\"),\n                        \"vehicle\": info,\n                        \"colorTrim\": colorTrim,\n                        \"stock\": item.stockNumber ? item.stockNumber : 'N/A',\n                        \"park\": pack,\n                        \"battery\": battery,\n                        \"batteryClass\": batteryClass,\n                        \"online\": onlineStatus,\n                        \"use\": item.available == 0 ? 'Available' : 'In Use',\n                        \"price\": item.price ? item.priceUnit + ' ' + self.formatNumber(item.price) : 'N/A',\n                        \"mileage\": item.currentMileage ? self.format_number((item.currentMileage * 0.0006214).toFixed(0)) : 'N/A',\n                        \"inventory\": item.inventoryDays ? item.inventoryDays + ' Days' : 'N/A',\n                        \"daysIdle\": item.lastFlameoutDay ? item.lastFlameoutDay + ' Days' : 'N/A',\n                        \"action\": \"<span>action</span>\",\n                        \"vehicleId\": item.vehicleId,\n                        \"unboundStatus\": item.isOnline == 3 ? 'Unbound' : '',\n                        \"info\": info,\n                        \"lat\": item.lastLocationLat,\n                        \"lng\": item.lastLocationLng,\n                        \"area\": item.areaCoordinates\n                    }\n                })\n            }\n        }\n\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .top-holder {\n        margin-top: 12px;\n    }\n    .filter-left{\n        .card-body{\n            padding-left: 0;\n        }\n        .text-primary{\n            padding-left: 0;\n        }\n        .col-sm-10{\n            padding-left: 0;\n        }\n    }\n    .vehicle {\n        width: 100%;\n\n        .link-to-detail {\n            cursor: pointer;\n            color: #20a8d8;\n\n            &:hover {\n                text-decoration: underline;\n            }\n        }\n\n        .search-group {\n            width: 40%;\n            margin-top: 2%;\n            display: inline-block;\n\n            input {\n                height: 40px;\n            }\n\n            button {\n                margin-left: 0px;\n                height: 36px;\n            }\n\n            a {\n                margin-left: 10%;\n            }\n        }\n\n        i {\n            margin-right: 4px;\n        }\n\n        .collapse-m {\n            border-color: #1FA8D8;\n            border-style: dashed;\n        }\n\n        .table-outline {\n            margin-top: 2%;\n        }\n\n        .filter-content {\n            display: inline-block;\n        }\n\n        .header-right {\n            float: right;\n\n            button {\n                background-color: #20a8d8 !important;\n                border-color: #20a8d8 !important;\n            }\n        }\n    }\n\n    .btn {\n        margin: 2px;\n    }\n\n    .mapLocation {\n\n    }\n\n    .photo-url {\n        img {\n            border-radius: 4px;\n        }\n\n        span {\n            position: absolute;\n            background-color: #73818f;\n            border-radius: 4px;\n            padding: 0.25rem;\n            font-size: 12px;\n        }\n\n        strong {\n\n        }\n    }\n</style>"]}]}