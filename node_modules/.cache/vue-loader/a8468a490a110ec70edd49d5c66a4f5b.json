{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/profile.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/profile.vue","mtime":1562919390000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpclient from \"@/utils/httpclient\"\nexport default {\n    name: \"profile\",\n    inject: ['reload'],\n    data() {\n        return {\n            data: null,\n            email: '',\n            firstname: '',\n            lastname: '',\n            phone: '',\n            role: '',\n            dealGroup: '',\n            dealship: '',\n            img: '',\n            showTip: false,\n            showETip: false\n        }\n    },\n    mounted() {\n        this.img = this.$store.state.userInfo.avatarUrl;\n        httpclient.post(\"/api/v1/getUserById\", {\n            userId: this.$store.state.userInfo.userId\n        }).then(response => {\n            this.email = response.data.data.userEmail ? response.data.data.userEmail : '';\n            this.firstname = response.data.data.firstName;\n            this.lastname = response.data.data.lastName;\n            this.phone = response.data.data.phone;\n            this.role = response.data.data.role;\n            this.dealship = response.data.data.storeName;\n            this.dealGroup = response.data.data.tenantName;\n        })\n    },\n    methods: {\n        savefile(event) {\n            let file = event.target.files;\n            let fb = new FormData();\n            fb.append(\"image\", file[0]);\n            httpclient.post('/api/v1/user/updateAvatar', fb).then(response => {\n                if (response.data.code === 200) {\n                    this.img = response.data.data.avatarUrl;\n                    let userPersonInfo = {\n                        avatarUrl:this.img,\n                        firstName:this.firstname,\n                        lastName:this.lastname\n                    };\n                    this.$store.dispatch('user_Personal_Info',userPersonInfo);  //更新store内用户信息\n                    let storeData = JSON.parse(localStorage.getItem(\"user_info\"));  //更新localstorage内用户信息\n                    storeData.avatarUrl = this.img;\n                    localStorage.setItem(\"user_info\", JSON.stringify(storeData));\n                    this.showTip = true;\n                } else {\n                    this.showETip = true;\n                }\n            })\n        },\n        saveUserInfo() {\n            if (this.firstname && this.lastname && this.phone) {\n                httpclient.post('/api/v1/updateuserdetail',{\n                    firstName: this.firstname,\n                    lastName: this.lastname,\n                    userPhone: this.phone\n                }).then((res) => {\n                     if(res.data.code === 200){\n                        let userPersonInfo = {\n                            avatarUrl:this.img,\n                            firstName:this.firstname,\n                            lastName:this.lastname\n                        };\n                        this.$store.dispatch('user_Personal_Info',userPersonInfo);\n                         let storeData = JSON.parse(localStorage.getItem(\"user_info\"));\n                         storeData.firstName = this.firstname;\n                         storeData.lastName = this.lastname;\n                         localStorage.setItem(\"user_info\", JSON.stringify(storeData));\n                         this.showTip = true;\n                     }\n                }).catch(()=>{\n                    this.showETip = true;\n                })\n            }\n        }\n    }\n}\n",null]}