{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue","mtime":1560750572000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpclient from '@/utils/httpclient';\nimport googleMap from '@components/googleMap'\nexport default {\n\tname: \"vehicle\",\n\tcomponents: {\n\t\tgoogleMap\n\t},\n\tinject: [\"reload\"],\n\tdata(){\n\t\treturn {\n\t\t\ttableFields: {\n\t\t\t\tphotoUrl: {\n\t\t\t\t\tlabel: 'Photo',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tvehicle: {\n\t\t\t\t\tlabel: 'Vehicle',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tpark: {\n\t\t\t\t\tlabel: 'Lot',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tbattery: {\n\t\t\t\t\tlabel: 'Voltage',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tonline: {\n\t\t\t\t\tlabel: 'Online/Offline',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tuse: {\n\t\t\t\t\tlabel: 'Available/In Use',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tprice: {\n\t\t\t\t\tlabel: 'Price',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tinventory: {\n\t\t\t\t\tlabel: 'Inventory Age',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\taction: {\n\t\t\t\t\tlabel: 'Actions',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdata: null,\n\t\t\ttable: null,\n\t\t\tshowMap: false,\n\t\t\tmap: {},\n\t\t\trows: 0,\n\t\t\tcurrentPage: 1,\n\t\t\ttotal: 0,\n\t\t\tperPage:10,\n\t\t\tshowDelMap: false,\n\t\t\tdelId: '',\n\t\t\tshowEtip: false,\n\t\t\tpageCount: 0,\n\t\t\tgFData: [],\n\t\t\tsearch: '',\n\t\t\tqueryData:{},\n\t\t}\n\t},\n\tmounted() {\n\t\tlet self = this;\n\t\tthis.axiosApi(self, 1, this.$route.query.filters ? JSON.parse(this.$route.query.filters) : []);\n\t\tthis.getFilter();\n\t\t//初始化checkbox勾选\n\t\tlet myData = this.$route.query.filters ? JSON.parse(this.$route.query.filters) : [];\n\t\tif(myData.length){\n\t\t\tmyData.map((item,i)=>{\n\t\t\t\tthis.queryData[item.key] = item.value;\n\t\t\t})\n\t\t}\n\n\t},\n\tmethods: {\n\t\tgetFilter() {\n\t\t\thttpclient.post('/api/v1/vehiclesearch/filter').then(response => {\n\t\t\t\tthis.gFData = response.data.data;\n\t\t\t}).catch(() => {\n\t\t\t});\n\t\t},\n\t\tsearchData() {\n\t\t\tlet search= [];\n\t\t\tlet keys = [];\n\t\t\tthis.$refs.checkbox.forEach((item) => {\n\t\t\t\tif (item.is_Checked) {\n\t\t\t\t\tif (keys.includes(item.name)) {\n\t\t\t\t\t\tfor (let it of search) {\n\t\t\t\t\t\t\tif (it.key == item.name) it.value.push(item.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsearch.push({\n\t\t\t\t\t\t\tkey: item.name,\n\t\t\t\t\t\t\tvalue: [item.value]\n\t\t\t\t\t\t});\n\t\t\t\t\t\tkeys.push(item.name)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.axiosApi(this, 1, search);\n\n\t\t},\n\t\taxiosApi(self, page, obj){\n\t\t\thttpclient.post(`/api/v1/vehiclesearch/searchnew?searchText=${this.search}&source=&pageNo=${page}&pageSize=10`, {\n\t\t\t\tfilters: obj\n\t\t\t}).then((response) => {\n\t\t\t\tself.data = response.data.data;\n\t\t\t\tself.total = response.data.data.rowCount ? response.data.data.rowCount : 0 ;\n\t\t\t\tself.currentPage = response.data.data.pageNo ? response.data.data.pageNo : 0;\n\t\t\t\tself.pageCount = response.data.data.pageCount ? response.data.data.pageCount : 0;\n\t\t\t\tthis.filterData(self.data.vehicles);\n\t\t\t}).catch((err) => {\n\t\t\t\talert(err)\n\t\t\t})\n\t\t},\n\t\tformatNumber(nStr){\n\t\t\tnStr += '';\n\t\t\tlet x = nStr.split('.');\n\t\t\tlet x1 = x[0];\n\t\t\tlet x2 = x.length > 1 ? '.' + x[1] : '';\n\t\t\tvar rgx = /(\\d+)(\\d{3})/;\n\t\t\twhile (rgx.test(x1)) {\n\t\t\t\tx1 = x1.replace(rgx, '$1' + ',' + '$2');\n\t\t\t}\n\t\t\treturn x1 + x2;\n\t\t},\n\t\tchangePage(page) {\n\t\t\tlet self = this;\n\t\t\tthis.axiosApi(self, page, []);\n\t\t},\n\t\tapiDel() {\n\t\t\thttpclient.post('/api/v1/vehicle/delete',{\n\t\t\t\tvehicleId: this.delId\n\t\t\t}).then(response => {\n\t\t\t\tif (response.data.code == 200) {\n\t\t\t\t\tthis.reload();\n\t\t\t\t} else {\n\t\t\t\t\tthis.showEtip = true;\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.showEtip = true;\n\t\t\t})\n\t\t},\n\t\tshowMapTip(lat, lng, area, info) {\n\t\t\tif (lat || area) {\n\t\t\t\tthis.map = {\n\t\t\t\t\tlat: lat,\n\t\t\t\t\tlng: lng,\n\t\t\t\t\tarea: area,\n\t\t\t\t\tvehicleInfo: info\n\t\t\t\t};\n\t\t\t\tthis.showMap = true;\n\t\t\t}\n\t\t},\n\t\thideModal(){\n\t\t\tthis.$refs['my-modal'].hide();\n\t\t},\n\t\tdelData(id){\n\t\t\tthis.delId = id;\n\t\t\tthis.showDelMap = true;\n\t\t},\n\t\tfilterData(data){\n\n\t\t\tlet self = this;\n\t\t\tthis.table = data.map(function (item) {\n\t\t\t\tlet pack = item.outStatus == 1 ? item.parkingName : \"N/A\";\n\t\t\t\tlet battery = null;\n\t\t\t\tlet batteryClass = null;\n\t\t\t\tif (item.currentVoltage) {\n\t\t\t\t\tlet numBat = item.currentVoltage.toFixed(1);\n\t\t\t\t\tbattery = item.currentVoltage.toFixed(1) + ' V';\n\t\t\t\t\tbatteryClass = numBat <= 11.7 ? 'badge-danger' : (numBat > 11.7 && numBat <= 12.1 ? 'badge-warning' : 'badge-success' );\n\t\t\t\t} else {\n\t\t\t\t\tbattery = \"N/A\";\n\t\t\t\t\tbatteryClass = 'badge-secondary';\n\t\t\t\t}\n\t\t\t\tlet onlineStatus = item.isOnline == 1 ? \"Online\" : \"Offline\";\n\t\t\t\tlet year = item.year ? item.year : 'N/A';\n\t\t\t\tlet make = item.make ? item.make : 'N/A';\n\t\t\t\tlet model = item.model ? item.model : 'N/A';\n\t\t\t\tlet info = (year == 'N/A' && make == 'N/A' && model == 'N/A') ? 'N/A' : year + ' ' + make + ' ' + model;\n\t\t\t\tlet color = item.color ? item.color : 'N/A';\n\t\t\t\tlet trim = item.trim ? item.trim : 'N/A';\n\t\t\t\tlet colorTrim = (color == 'N/A' && trim == 'N/A') ? 'N/A' : color + ' , ' + trim;\n\t\t\t\treturn {\n\t\t\t\t\t\"photoUrl\": item.photoUrl ? item.photoUrl : require(\"@/assets/pages-img/placeholder.svg\"),\n\t\t\t\t\t\"vehicle\": info,\n\t\t\t\t\t\"colorTrim\":colorTrim,\n\t\t\t\t\t\"stock\": item.stockNumber ? item.stockNumber : 'N/A',\n\t\t\t\t\t\"park\": pack,\n\t\t\t\t\t\"battery\": battery,\n\t\t\t\t\t\"batteryClass\": batteryClass,\n\t\t\t\t\t\"online\": onlineStatus,\n\t\t\t\t\t\"use\": item.available == 0 ? 'Available' : 'In Use',\n\t\t\t\t\t\"price\": item.price ? item.priceUnit + ' ' + self.formatNumber(item.price) : 'N/A',\n\t\t\t\t\t\"inventory\": item.inventoryDays ? item.inventoryDays + ' Days' : 'N/A',\n\t\t\t\t\t\"action\": \"<span>action</span>\",\n\t\t\t\t\t\"vehicleId\": item.vehicleId,\n\t\t\t\t\t\"unboundStatus\": item.isOnline == 3 ? 'Unbound' : '',\n\t\t\t\t\t\"info\": info,\n\t\t\t\t\t\"lat\": item.lastLocationLat,\n\t\t\t\t\t\"lng\": item.lastLocationLng,\n\t\t\t\t\t\"area\": item.areaCoordinates\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n}\n",{"version":3,"sources":["vehicle.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+LA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"vehicle.vue","sourceRoot":"src/views/dashboard/dashboardMain","sourcesContent":["<template>\n\t<div class=\"animated fadeIn vehicle\">\n\t\t<b-card style=\"width: 100%;\">\n\t\t\t<div slot=\"header\">\n\t\t\t\t<i class='fa fa-automobile'></i>\n\t\t\t\t<span>Vehicles</span>\n\t\t\t\t<div class=\"header-right\">\n\t\t\t\t\t<b-button class=\"btn btn-sm btn-primary mr-2\" @click=\"$router.push('/add-vehicle')\">\n\t\t\t\t\t\t<i class=\"fa fa-plus-square\"></i>\n\t\t\t\t\t\tAdd Inventory\n\t\t\t\t\t</b-button>\n\t\t\t\t\t<b-button class=\"btn btn-sm btn-primary mr-2\" @click=\"$router.push('/bind-vehicle')\">\n\t\t\t\t\t\t<i class=\"fa fa-wrench\"></i>\n\t\t\t\t\t\tDevice Installation\n\t\t\t\t\t</b-button>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div>\n\t\t\t\t<b-form-group label-for=\"elementsAppendButton\" class=\"search-group\">\n\t\t\t\t\t<b-input-group>\n\t\t\t\t\t\t<b-form-input type=\"text\" v-model=\"search\"></b-form-input>\n\t\t\t\t\t\t<b-input-group-append>\n\t\t\t\t\t\t\t<b-button variant=\"primary\" @click=\"searchData\"><i class=\"fa fa-search\"></i>Search</b-button>\n\t\t\t\t\t\t</b-input-group-append>\n\t\t\t\t\t</b-input-group>\n\t\t\t\t</b-form-group>\n\n\t\t\t\t<b-btn v-b-toggle.collapse class=\"m-1 btn btn-outline-info\">\n\t\t\t\t\t<i class=\"fa fa-filter\"></i>Filters\n\t\t\t\t</b-btn>\n\t\t\t</div>\n\t\t\t<b-collapse id=\"collapse\">\n\t\t\t\t<b-card class=\"collapse-m\" style=\"width: 100%\">\n\t\t\t\t\t<template v-for=\"item in gFData\">\n\t\t\t\t\t\t<b-row :key=\"item.label\">\n\t\t\t\t\t\t\t<b-col sm=\"2\" class=\"text-primary\">\n\t\t\t\t\t\t\t\t{{ item.label }}\n\t\t\t\t\t\t\t</b-col>\n\t\t\t\t\t\t\t<b-col sm=\"10\">\n\t\t\t\t\t\t\t\t<div v-for=\"it in item.filters\" :key=\"it.value\" class=\"filter-content\">\n\t\t\t\t\t\t\t\t\t<b-form-checkbox-group v-model=\"queryData[item.key]\">\n\t\t\t\t\t\t\t\t\t\t<b-form-checkbox  :value=\"it.value\" :name=\"item.key\" ref=\"checkbox\" :checked=\"queryData[item.key]\">\n\t\t\t\t\t\t\t\t\t\t\t{{ it.key }}\n\t\t\t\t\t\t\t\t\t\t</b-form-checkbox>\n\t\t\t\t\t\t\t\t\t</b-form-checkbox-group>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</b-col>\n\t\t\t\t\t\t</b-row>\n\t\t\t\t\t</template>\n\t\t\t\t</b-card>\n\t\t\t</b-collapse>\n\t\t\t<b-table class=\"mb-0 table-outline\" small striped responsive=\"sm\" :items=\"table\" hover :fields=\"tableFields\" head-variant=\"light\">\n\t\t\t\t<template slot=\"photoUrl\" slot-scope=\"data\">\n\t\t\t\t\t<div class=\"photo-url\" @click=\"$router.push('/vehicle-detail/' + data.item.vehicleId)\">\n\t\t\t\t\t\t<span>{{ data.item.unboundStatus }}</span>\n\t\t\t\t\t\t<img :src=\"data.item.photoUrl\" width=\"100px\" height=\"100px\">\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template slot=\"battery\" slot-scope=\"data\">\n\t\t\t\t\t<span class=\"badge badge-pill\" :class=\"data.item.batteryClass ? data.item.batteryClass : '' \">{{ data.item.battery }}</span>\n\t\t\t\t</template>\n\t\t\t\t<template slot=\"vehicle\" slot-scope=\"data\">\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<div @click=\"$router.push(`/vehicle-detail/${data.item.vehicleId}`)\"><strong class=\"link-to-detail\">{{data.item.vehicle}}</strong></div>\n\t\t\t\t\t\t<div>{{data.item.colorTrim}}</div>\n\t\t\t\t\t\t<div>{{data.item.stock}}</div>\n\t\t\t\t\t</div>\n\t\t\t\t</template>\n\t\t\t\t<template slot=\"online\" slot-scope=\"data\">\n\t\t\t\t\t<span class=\"badge badge-pill\" :class=\"data.item.online == 'Online' ? 'badge-success' : 'btn-secondary' \">{{ data.item.online }}</span>\n\t\t\t\t</template>\n\t\t\t\t<template slot=\"use\" slot-scope=\"data\">\n\t\t\t\t\t<span class=\"badge badge-pill\" :class=\"data.item.use == 'Available' ? 'badge-success' : 'btn-danger' \">{{ data.item.use }}</span>\n\t\t\t\t</template>\n\t\t\t\t<template slot=\"action\" slot-scope=\"data\">\n\t\t\t\t\t<div class=\"mapLocation\" @click=\"showMapTip(data.item.lat, data.item.lng, data.item.area, data.item.info)\"><i class=\"cui cui-location-pin btn btn-sm btn-secondary\" :class=\"data.item.lat || data.item.area ? 'btn-success' : '' \"></i></div>\n\t\t\t\t\t<div class=\"btn btn-sm btn-info vehicledetail\" @click=\"$router.push('/vehicle-detail/' + data.item.vehicleId)\"><i class=\"fa fa-eye\"></i></div>\n\t\t\t\t\t<div class=\"btn btn-sm btn-info vehicleedit\" @click=\"$router.push('/vehicle-edit/' + data.item.vehicleId)\"><i class=\"fa fa-edit\"></i></div>\n\t\t\t\t\t<div v-b-modal.del-1 class=\"btn btn-sm btn-danger btn-del\" @click=\"delData(data.item.vehicleId)\"><i class=\"cui cui-trash\"></i></div>\n\t\t\t\t</template>\n\t\t\t</b-table>\n\n\t\t\t<b-row>\n\t\t\t\t<b-col sm=\"4\" lg=\"4\">\n\t\t\t\t\t<div class=\"dataTables_info\" id=\"DataTables0\" role=\"status\" aria-live=\"polite\">\n\t\t\t\t\t\t<span v-if=\"total > 0\">\n\t\t\t\t\t\t\tShowing {{10 * (currentPage - 1) + 1 }} to {{currentPage === pageCount? total :currentPage * 10 }} of {{total}} entries\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span v-else>\n\t\t\t\t\t\t\tShowing 0 to 0 of {{total}} entries\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</b-col>\n\t\t\t\t<b-col sm=\"8\" lg=\"8\">\n\t\t\t\t\t<b-pagination align=\"right\" :total-rows=\"total\" v-model=\"currentPage\" :per-page=\"perPage\" @input=\" changePage(currentPage)\"></b-pagination>\n\t\t\t\t</b-col>\n\t\t\t</b-row>\n\n\n\t\t</b-card>\n\t\t<div class=\"del-tip\">\n\t\t\t<b-modal ref=\"my-modal\" hide-footer title=\"Are you sure to delete the vehicles?\" v-model=\"showDelMap\" @ok=\"showDelMap = false\">\n\t\t\t\t<b-button @click=\"hideModal\">Cancel</b-button>\n\t\t\t\t<b-button class=\"btn btn-primary\" @click=\"apiDel\">Ok</b-button>\n\t\t\t</b-modal>\n\t\t</div>\n\n\t\t<b-modal ref=\"my-modal\" v-model=\"showMap\" @ok=\"showMap = false\">\n\t\t\t<google-map\n\t\t\t\t\t:map=\"map\"\n\t\t\t></google-map>\n\t\t</b-modal>\n\n\t\t<b-modal ref=\"my-modal\" v-model=\"showEtip\" @ok=\"showEtip = false\">\n\t\t\t<b-button>Cancel</b-button>\n\t\t\t<b-button class=\"btn btn-primary\">Ok</b-button>\n\t\t</b-modal>\n\t</div>\n</template>\n\n<style lang=\"scss\" scoped>\n\t.vehicle {\n\t\twidth: 100%;\n\t\t.link-to-detail{\n\t\t\tcursor: pointer;\n\t\t\tcolor: #20a8d8;\n\t\t\t&:hover{\n\t\t\t\ttext-decoration: underline;\n\t\t\t}\n\t\t}\n\n\t\t.search-group {\n\t\t\twidth: 40%;\n\t\t\tmargin-top: 2%;\n\t\t\tdisplay: inline-block;\n\t\t\tinput {\n\t\t\t\theight: 40px;\n\t\t\t}\n\t\t\tbutton {\n\t\t\t\tmargin-left: 0px;\n\t\t\t\theight: 36px;\n\t\t\t}\n\t\t\ta {\n\t\t\t\tmargin-left: 10%;\n\t\t\t}\n\t\t}\n\t\ti {\n\t\t\tmargin-right: 4px;\n\t\t}\n\t\t.collapse-m {\n\t\t\tborder-color: #1FA8D8;\n\t\t\tborder-style: dashed;\n\t\t}\n\t\t.table-outline {\n\t\t\tmargin-top: 2%;\n\t\t}\n\t\t.filter-content {\n\t\t\tdisplay: inline-block;\n\t\t}\n\t\t.header-right {\n\t\t\tfloat: right;\n\t\t\tbutton {\n\t\t\t\tbackground-color: #20a8d8!important;\n\t\t\t\tborder-color: #20a8d8!important;\n\t\t\t}\n\t\t}\n\t}\n\t.btn {\n\t\tmargin: 2px;\n\t}\n\t.mapLocation {\n\n\t}\n\t.photo-url {\n\t\timg {\n\t\t\tborder-radius: 4px;\n\t\t}\n\t\tspan {\n\t\t\tposition: absolute;\n\t\t\tbackground-color: #73818f;\n\t\t\tborder-radius: 4px;\n\t\t\tpadding: 0.25rem;\n\t\t\tfont-size: 12px;\n\t\t}\n\t\tstrong {\n\n\t\t}\n\t}\n</style>\n\n<script>\n\timport httpclient from '@/utils/httpclient';\n\timport googleMap from '@components/googleMap'\n\texport default {\n\t\tname: \"vehicle\",\n\t\tcomponents: {\n\t\t\tgoogleMap\n\t\t},\n\t\tinject: [\"reload\"],\n\t\tdata(){\n\t\t\treturn {\n\t\t\t\ttableFields: {\n\t\t\t\t\tphotoUrl: {\n\t\t\t\t\t\tlabel: 'Photo',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tvehicle: {\n\t\t\t\t\t\tlabel: 'Vehicle',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tpark: {\n\t\t\t\t\t\tlabel: 'Lot',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tbattery: {\n\t\t\t\t\t\tlabel: 'Voltage',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tonline: {\n\t\t\t\t\t\tlabel: 'Online/Offline',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tuse: {\n\t\t\t\t\t\tlabel: 'Available/In Use',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tprice: {\n\t\t\t\t\t\tlabel: 'Price',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\tinventory: {\n\t\t\t\t\t\tlabel: 'Inventory Age',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t},\n\t\t\t\t\taction: {\n\t\t\t\t\t\tlabel: 'Actions',\n\t\t\t\t\t\tclass: 'text-center'\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tdata: null,\n\t\t\t\ttable: null,\n\t\t\t\tshowMap: false,\n\t\t\t\tmap: {},\n\t\t\t\trows: 0,\n\t\t\t\tcurrentPage: 1,\n\t\t\t\ttotal: 0,\n\t\t\t\tperPage:10,\n\t\t\t\tshowDelMap: false,\n\t\t\t\tdelId: '',\n\t\t\t\tshowEtip: false,\n\t\t\t\tpageCount: 0,\n\t\t\t\tgFData: [],\n\t\t\t\tsearch: '',\n\t\t\t\tqueryData:{},\n\t\t\t}\n\t\t},\n\t\tmounted() {\n\t\t\tlet self = this;\n\t\t\tthis.axiosApi(self, 1, this.$route.query.filters ? JSON.parse(this.$route.query.filters) : []);\n\t\t\tthis.getFilter();\n\t\t\t//初始化checkbox勾选\n\t\t\tlet myData = this.$route.query.filters ? JSON.parse(this.$route.query.filters) : [];\n\t\t\tif(myData.length){\n\t\t\t\tmyData.map((item,i)=>{\n\t\t\t\t\tthis.queryData[item.key] = item.value;\n\t\t\t\t})\n\t\t\t}\n\n\t\t},\n\t\tmethods: {\n\t\t\tgetFilter() {\n\t\t\t\thttpclient.post('/api/v1/vehiclesearch/filter').then(response => {\n\t\t\t\t\tthis.gFData = response.data.data;\n\t\t\t\t}).catch(() => {\n\t\t\t\t});\n\t\t\t},\n\t\t\tsearchData() {\n\t\t\t\tlet search= [];\n\t\t\t\tlet keys = [];\n\t\t\t\tthis.$refs.checkbox.forEach((item) => {\n\t\t\t\t\tif (item.is_Checked) {\n\t\t\t\t\t\tif (keys.includes(item.name)) {\n\t\t\t\t\t\t\tfor (let it of search) {\n\t\t\t\t\t\t\t\tif (it.key == item.name) it.value.push(item.value);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsearch.push({\n\t\t\t\t\t\t\t\tkey: item.name,\n\t\t\t\t\t\t\t\tvalue: [item.value]\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tkeys.push(item.name)\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis.axiosApi(this, 1, search);\n\n\t\t\t},\n\t\t\taxiosApi(self, page, obj){\n\t\t\t\thttpclient.post(`/api/v1/vehiclesearch/searchnew?searchText=${this.search}&source=&pageNo=${page}&pageSize=10`, {\n\t\t\t\t\tfilters: obj\n\t\t\t\t}).then((response) => {\n\t\t\t\t\tself.data = response.data.data;\n\t\t\t\t\tself.total = response.data.data.rowCount ? response.data.data.rowCount : 0 ;\n\t\t\t\t\tself.currentPage = response.data.data.pageNo ? response.data.data.pageNo : 0;\n\t\t\t\t\tself.pageCount = response.data.data.pageCount ? response.data.data.pageCount : 0;\n\t\t\t\t\tthis.filterData(self.data.vehicles);\n\t\t\t\t}).catch((err) => {\n\t\t\t\t\talert(err)\n\t\t\t\t})\n\t\t\t},\n\t\t\tformatNumber(nStr){\n\t\t\t\tnStr += '';\n\t\t\t\tlet x = nStr.split('.');\n\t\t\t\tlet x1 = x[0];\n\t\t\t\tlet x2 = x.length > 1 ? '.' + x[1] : '';\n\t\t\t\tvar rgx = /(\\d+)(\\d{3})/;\n\t\t\t\twhile (rgx.test(x1)) {\n\t\t\t\t\tx1 = x1.replace(rgx, '$1' + ',' + '$2');\n\t\t\t\t}\n\t\t\t\treturn x1 + x2;\n\t\t\t},\n\t\t\tchangePage(page) {\n\t\t\t\tlet self = this;\n\t\t\t\tthis.axiosApi(self, page, []);\n\t\t\t},\n\t\t\tapiDel() {\n\t\t\t\thttpclient.post('/api/v1/vehicle/delete',{\n\t\t\t\t\tvehicleId: this.delId\n\t\t\t\t}).then(response => {\n\t\t\t\t\tif (response.data.code == 200) {\n\t\t\t\t\t\tthis.reload();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.showEtip = true;\n\t\t\t\t\t}\n\t\t\t\t}).catch(() => {\n\t\t\t\t\tthis.showEtip = true;\n\t\t\t\t})\n\t\t\t},\n\t\t\tshowMapTip(lat, lng, area, info) {\n\t\t\t\tif (lat || area) {\n\t\t\t\t\tthis.map = {\n\t\t\t\t\t\tlat: lat,\n\t\t\t\t\t\tlng: lng,\n\t\t\t\t\t\tarea: area,\n\t\t\t\t\t\tvehicleInfo: info\n\t\t\t\t\t};\n\t\t\t\t\tthis.showMap = true;\n\t\t\t\t}\n\t\t\t},\n\t\t\thideModal(){\n\t\t\t\tthis.$refs['my-modal'].hide();\n\t\t\t},\n\t\t\tdelData(id){\n\t\t\t\tthis.delId = id;\n\t\t\t\tthis.showDelMap = true;\n\t\t\t},\n\t\t\tfilterData(data){\n\n\t\t\t\tlet self = this;\n\t\t\t\tthis.table = data.map(function (item) {\n\t\t\t\t\tlet pack = item.outStatus == 1 ? item.parkingName : \"N/A\";\n\t\t\t\t\tlet battery = null;\n\t\t\t\t\tlet batteryClass = null;\n\t\t\t\t\tif (item.currentVoltage) {\n\t\t\t\t\t\tlet numBat = item.currentVoltage.toFixed(1);\n\t\t\t\t\t\tbattery = item.currentVoltage.toFixed(1) + ' V';\n\t\t\t\t\t\tbatteryClass = numBat <= 11.7 ? 'badge-danger' : (numBat > 11.7 && numBat <= 12.1 ? 'badge-warning' : 'badge-success' );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbattery = \"N/A\";\n\t\t\t\t\t\tbatteryClass = 'badge-secondary';\n\t\t\t\t\t}\n\t\t\t\t\tlet onlineStatus = item.isOnline == 1 ? \"Online\" : \"Offline\";\n\t\t\t\t\tlet year = item.year ? item.year : 'N/A';\n\t\t\t\t\tlet make = item.make ? item.make : 'N/A';\n\t\t\t\t\tlet model = item.model ? item.model : 'N/A';\n\t\t\t\t\tlet info = (year == 'N/A' && make == 'N/A' && model == 'N/A') ? 'N/A' : year + ' ' + make + ' ' + model;\n\t\t\t\t\tlet color = item.color ? item.color : 'N/A';\n\t\t\t\t\tlet trim = item.trim ? item.trim : 'N/A';\n\t\t\t\t\tlet colorTrim = (color == 'N/A' && trim == 'N/A') ? 'N/A' : color + ' , ' + trim;\n\t\t\t\t\treturn {\n\t\t\t\t\t\t\"photoUrl\": item.photoUrl ? item.photoUrl : require(\"@/assets/pages-img/placeholder.svg\"),\n\t\t\t\t\t\t\"vehicle\": info,\n\t\t\t\t\t\t\"colorTrim\":colorTrim,\n\t\t\t\t\t\t\"stock\": item.stockNumber ? item.stockNumber : 'N/A',\n\t\t\t\t\t\t\"park\": pack,\n\t\t\t\t\t\t\"battery\": battery,\n\t\t\t\t\t\t\"batteryClass\": batteryClass,\n\t\t\t\t\t\t\"online\": onlineStatus,\n\t\t\t\t\t\t\"use\": item.available == 0 ? 'Available' : 'In Use',\n\t\t\t\t\t\t\"price\": item.price ? item.priceUnit + ' ' + self.formatNumber(item.price) : 'N/A',\n\t\t\t\t\t\t\"inventory\": item.inventoryDays ? item.inventoryDays + ' Days' : 'N/A',\n\t\t\t\t\t\t\"action\": \"<span>action</span>\",\n\t\t\t\t\t\t\"vehicleId\": item.vehicleId,\n\t\t\t\t\t\t\"unboundStatus\": item.isOnline == 3 ? 'Unbound' : '',\n\t\t\t\t\t\t\"info\": info,\n\t\t\t\t\t\t\"lat\": item.lastLocationLat,\n\t\t\t\t\t\t\"lng\": item.lastLocationLng,\n\t\t\t\t\t\t\"area\": item.areaCoordinates\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t}\n\n\t}\n</script>"]}]}