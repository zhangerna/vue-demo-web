{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/carBox.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/carBox.vue","mtime":1568972645000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.carbox {\n    .is-invalid {\n        \n    }\n}\n",{"version":3,"sources":["carBox.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqEA;AACA;;AAEA;AACA","file":"carBox.vue","sourceRoot":"src/views/dashboard/testDrive","sourcesContent":["<template>\n    <div class=\"animated fadeIn shop carbox\">\n        <b-card>\n            <div slot=\"header\">\n                <i class=\"nav-icon cui-tablet\"></i>\n                {{ $t('m.dashboard.devices') }}\n                <button class=\"btn btn-sm btn-primary link-bind\" style=\"float: right\" @click=\"installTip\">\n                    <i class=\"fa fa-wrench\"></i>\n                    {{ $t('m.vehicle.b_install') }}\n                </button>\n            </div>\n            <div class=\"content\">\n                <b-table class=\"mb-0 table-outline table-responsive-sm\" small striped responsive=\"sm\" :items=\"table\" hover :fields=\"tableFields\">\n                    <template slot=\"actions\" slot-scope=\"data\">\n                        <template v-if=\"data.item.vin != 'N/A'\">\n                            <div class=\"btn btn-sm btn-danger placeholder\" style=\"margin-right: 4px\" @click=\"unpairVehicle(data.item.deviceId)\">\n                                <i class=\"fa fa-close\"></i> {{ $t('m.common.b_unpair') }}\n                            </div>\n                        </template>\n                        <template v-else>\n                            <div class=\"btn btn-sm btn-primary placeholder\" style=\"margin-right: 4px\" @click=\"bindVehicle(data.item.imei)\">\n                                <i class=\"fa fa-wrench\"></i>{{ $t('m.device.b_install') }}\n                            </div>\n                        </template>\n                        <div class=\"btn btn-sm btn-danger btn-del\" @click=\"delIdM(data.item.deviceId)\">\n                            <i class=\"cui cui-trash\" ></i>{{ $t('m.device.b_del') }}\n                        </div>\n                    </template>\n                </b-table>\n            </div>\n            <b-row style=\"margin-top: 10px;\">\n                <b-col sm=\"4\" lg=\"4\">\n                    <div class=\"dataTables_info\" id=\"DataTables0\" role=\"status\" aria-live=\"polite\">\n                        {{ $t('m.common.show') }} {{10 * (currentPage - 1) + 1 }} {{ $t('m.common.to') }} {{currentPage === totalPages? total :currentPage * 10 }} {{ $t('m.common.of') }} {{total}} {{ $t('m.common.entries') }}\n                    </div>\n                </b-col>\n                <b-col sm=\"8\" lg=\"8\">\n                    <b-pagination align=\"right\" :total-rows=\"total\" v-model=\"currentPage\" :per-page=\"10\" @input=\" changePage(currentPage)\"></b-pagination>\n                </b-col>\n            </b-row>\n        </b-card>\n        <b-modal ref=\"my-modal\" :title=\"$t('m.cloud.install_box')\" :ok-title=\"$t('m.tip.b_ok')\" v-model=\"showBindTip\" @ok=\"bindDeviceData()\" ok-only>\n            <p>{{ $t('m.cloud.box_tip1') }}</p>\n            <p>{{ $t('m.cloud.box_tip2') }}</p>\n            <p style=\"color: red\">{{ $t('m.cloud.box_tip3') }}</p>\n            <b-form-group class=\"vehicle-id\">\n                <b-input-group>\n                    <b-input-group-prepend>\n                        <b-input-group-text>{{$t('m.common.imei2')}}</b-input-group-text>\n                    </b-input-group-prepend>\n                    <b-form-input v-model=\"curImei\"  type=\"number\" maxlength=\"15\" minlength=\"15\" :class=\"imeiIsVaild ? 'is-invalid' : ''\"></b-form-input>\n                </b-input-group>\n            </b-form-group>\n            <b-form-group>\n                <b-input-group>\n                    <b-input-group-prepend>\n                        <b-input-group-text>{{$t('m.cloud.vehicle_type')}}</b-input-group-text>\n                    </b-input-group-prepend>\n                    <select class=\"form-control\" name=\"\" v-model=\"vehicleType\">\n                        <option value=\"0\">{{ $t('m.cloud.vehicle_type_p') }}</option>\n                        <option v-for=\"(item, index) in vehicleList\" :key=\"index\" :value=\"item.vehicleId\">{{item.vehicleYear ? item.vehicleYear : 'N/A' }} {{ item.vehicleMake ? item.vehicleMake : 'N/A' }} {{ item.vehicleModel ? item.vehicleModel : 'N/A' }} {{ item.vehicleAlias ? \"-\" + item.vehicleAlias : 'N/A' }},VIN:{{ item.vin }} </option>\n                    </select>\n                </b-input-group>\n            </b-form-group>\n        </b-modal>\n    </div>\n</template>\n\n<style>\n    .carbox {\n        .is-invalid {\n            \n        }\n    }\n</style>\n\n<script>\n    import httpClient from \"@/utils/httpclient\";\n    export default {\n        name: \"shopManager\",\n        inject: [\"reload\"],\n        watch: {\n            curImei (newV) {\n                if (newV.length == 15) {\n                    this.imeiIsVaild = true;\n                } else {\n                    this.imeiIsVaild = false;\n                }\n            }\n        },\n        data () {\n            return {\n                imeiIsVaild: true,\n                tableFields: {\n                    imei: {\n                        label: this.$t('m.common.imei2'),\n                        class: \"text-center\"\n                    },\n                    vin: {\n                        label: this.$t('m.common.vin2'),\n                        class: \"text-center\"\n                    },\n                    actions: {\n                        label: this.$t('m.vehicle.actions'),\n                        class: \"Actions\"\n                    }\n                },\n                curImei: '',\n                table: null,\n                showBindTip: false,\n                currentPage: 1,\n                pageSize: 10,\n                total: 0,\n                totalPages:0,\n                showTip: false,\n                curName: '',\n                vehicleList: [],\n                vehicleType: ''\n            }\n        },\n        mounted() {\n            this.initData(this.currentPage, this.pageSize);\n        },\n        methods: {\n            initData(page) {\n                httpClient.get(`/api/v1/clouddrive/device/box/pagelist?pageNo=${page}&pageSize=${this.pageSize}`).then(response => {\n                    if (response.data.code == 200 && response.data.data.datas) {\n                        this.total = response.data.data.rowCount;\n                        this.pageCount = response.data.data.totalPages;\n                        this.filterData(response.data.data.datas ? response.data.data.datas : []);\n                    }\n                })\n            },\n            installTip() {\n                httpClient.get('/api/v1/clouddrive/vehicle/unbindlist').then(res => {\n                    if (res.data.code == 200) {\n                        this.vehicleList = res.data.data;\n                        this.showBindTip = true;\n                    }\n                });\n            },\n            bindVehicle(imei){\n                this.curImei = imei;\n                this.showBindTip = true;\n            },\n            unpairVehicle(id) {\n                httpClient.post('/api/v1/clouddrive/device/box/unbind', {\n                    deviceId: id\n                }).then(res => {\n                    if (res.data.code == 200 && res.data.data.result) {\n                        this.reload();\n                    } else {\n                        alert(\"解绑失败\");\n                    }\n                });\n            },\n            delIdM(id) {\n                httpClient.post('/api/v1/clouddrive/device/box/delete', {\n                    deviceId: id\n                }).then(res => {\n                    if (res.data.code == 200 && res.data.data.result) {\n                        this.reload();\n                    } else {\n                        alert(\"删除失败\");\n                    }\n                });\n            },\n            filterData(data) {\n                this.table = data.map(item => {\n                    return {\n                        imei: item.deviceImei,\n                        vin: item.vin ? item.vin : 'N/A',\n                        id: item.vehicleId,\n                        deviceType: item.deviceType ? item.deviceType : 'N/A',\n                        deviceId: item.deviceId,\n                    }\n                });\n            },\n            bindDeviceData() {\n                if (this.vehicleType && this.curImei) {\n                    httpClient.post('/api/v1/clouddrive/device/box/bind', {\n                        deviceImei: this.curImei,\n                        vehicleId: this.vehicleType\n                    }).then(res => {\n                        if (res.data.code == 200 && res.data.data.result) {\n                            this.reload();\n                        } else {\n                            alert(res.data.data.content);\n                        }\n                    });\n                }\n            },\n            prevPage(){\n                this.initData(this.currentPage > 1  ? this.currentPage - 1 : 1)\n            },\n            nextPage(){\n                this.initData(this.currentPage >= this.pageCount  ? this.currentPage : this.currentPage + 1)\n            },\n            changePage(page) {\n                this.initData(page);\n            }\n        }\n    }\n</script>\n"]}]}