{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue","mtime":1560922401000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nimport model from \"@/components/model\";\nexport default {\n    name: \"device\",\n    inject: ['reload'],\n    components: {\n        model\n    },\n    data(){\n        return {\n            tableFields: {\n                imei: {\n                    label: \"IMEI\",\n                    class: \"text-center\"\n                },\n                vin: {\n                    label: \"Related Vehicle VIN\",\n                    class: \"text-center\"\n                },\n                actions: {\n                    label: \"Related Vehicle VIN\",\n                    class: \"Actions\"\n                }\n            },\n            table: null,\n            currentPage: 1,\n            pageSize: 10,\n            total: 0,\n            totalPages:0,\n            show: false,\n            unpairVin: '',\n            title: '',\n            content: '',\n            btnGroup: {btnFirst:'Cancel', btnSecond: 'OK'},\n            delId: '',\n            currentOpa: false\n\n        }\n    },\n    mounted() {\n        this.initData(this.currentPage, this.pageSize);\n    },\n    methods: {\n        initData(page) {\n            httpClient.post(`/api/v1/vehicle/listBindDevice?pageNo=${page}&pageSize=${this.pageSize}`).\n            then(response => {\n                this.currentPage = response.data.data.pageNo;\n                this.total = response.data.data.rowCount;\n                this.filterData(response.data.data);\n                this.totalPages = response.data.data.totalPages\n            })\n        },\n        filterData(data) {\n            this.table = data.datas.map((item) => {\n                return {\n                    imei: item.deviceMac,\n                    vin: item.vin ? item.vin : 'N/A',\n                    id: item.vehicleId,\n                    deviceId: item.deviceId,\n                }\n            });\n\n        },\n        changePage(page) {\n            this.initData(page, this.pageSize);\n        },\n        unpairVehicle(id, imei){\n            this.unpairVin = {\n                vin: id,\n                deviceMac: imei\n            };\n            this.currentOpa = 'unpair';\n            this.show = true;\n            this.title = 'Confirm';\n            this.content = 'Are you sure to unpair the device and vehicle ?';\n        },\n        unbindVIn() {\n            httpClient.post('/api/v1/vehicle/unbind/device', {\n                deviceMac: this.unpairVin.deviceMac,\n                vin: this.unpairVin.vin\n            }).then(response => {\n                if (response.data.code == 200) {\n                    this.reload();\n                } else {\n                    this.show = true;\n                    this.title = 'Error';\n                    this.content = 'unbind error';\n                    this.btnGroup.btnSecond = '';\n                }\n            })\n        },\n        delDevice() {\n            httpClient.post('/api/v1/device/delete', {\n                deviceId: this.delId\n            }).then(response => {\n                if (response.data.code == 200) {\n                    this.reload();\n                } else {\n                    this.show = true;\n                    this.title = 'Error';\n                    this.content = 'delete error';\n                    this.btnGroup.btnSecond = '';\n                }\n            })\n        },\n        closeBox(type) {\n            if (type) {\n                this.currentOpa == \"del\" ? this.delDevice() : this.unbindVIn();\n            } else {\n                this.show = false;\n            }\n        },\n        delIdM(id) {\n            this.delId = id;\n            this.currentOpa = 'del';\n            this.show = true;\n            this.title = 'Warning';\n            this.content = 'Are you sure to delete the device?';\n        }\n    }\n}\n",null]}