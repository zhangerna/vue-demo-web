{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/carBox.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/carBox.vue","mtime":1569392859000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nexport default {\n    name: \"shopManager\",\n    inject: [\"reload\"],\n    watch: {\n        curImei (newV) {\n            if (newV.length == 15) {\n                this.imeiIsVaild = true;\n            } else {\n                this.imeiIsVaild = false;\n            }\n        }\n    },\n    data () {\n        return {\n            imeiIsVaild: true,\n            tableFields: {\n                imei: {\n                    label: this.$t('m.common.imei2'),\n                    class: \"text-center\"\n                },\n                vin: {\n                    label: this.$t('m.common.vin2'),\n                    class: \"text-center\"\n                },\n                actions: {\n                    label: this.$t('m.vehicle.actions'),\n                    class: \"Actions\"\n                }\n            },\n            curImei: '',\n            table: null,\n            showBindTip: false,\n            currentPage: 1,\n            pageSize: 10,\n            total: 0,\n            totalPages:0,\n            showTip: false,\n            curName: '',\n            vehicleList: [],\n            vehicleType: ''\n        }\n    },\n    mounted() {\n        this.initData(this.currentPage, this.pageSize);\n    },\n    methods: {\n        initData(page) {\n            httpClient.get(`/api/v1/clouddrive/device/box/pagelist?pageNo=${page}&pageSize=${this.pageSize}`).then(response => {\n                if (response.data.code == 200 && response.data.data.datas) {\n                    this.total = response.data.data.rowCount;\n                    this.pageCount = response.data.data.totalPages;\n                    this.filterData(response.data.data.datas ? response.data.data.datas : []);\n                }\n            })\n        },\n        installTip() {\n            httpClient.get('/api/v1/clouddrive/vehicle/unbindlist').then(res => {\n                if (res.data.code == 200) {\n                    this.vehicleList = res.data.data;\n                    this.showBindTip = true;\n                }\n            });\n        },\n        bindVehicle(imei){\n            this.curImei = imei;\n            this.showBindTip = true;\n        },\n        unpairVehicle(id) {\n            httpClient.post('/api/v1/clouddrive/device/box/unbind', {\n                deviceId: id\n            }).then(res => {\n                if (res.data.code == 200 && res.data.data.result) {\n                    this.reload();\n                } else {\n                    alert(\"解绑失败\");\n                }\n            });\n        },\n        delIdM(id) {\n            httpClient.post('/api/v1/clouddrive/device/box/delete', {\n                deviceId: id\n            }).then(res => {\n                if (res.data.code == 200 && res.data.data.result) {\n                    this.reload();\n                } else {\n                    alert(\"删除失败\");\n                }\n            });\n        },\n        filterData(data) {\n            this.table = data.map(item => {\n                return {\n                    imei: item.deviceImei,\n                    vin: item.vin ? item.vin : 'N/A',\n                    id: item.vehicleId,\n                    deviceType: item.deviceType ? item.deviceType : 'N/A',\n                    deviceId: item.deviceId,\n                }\n            });\n        },\n        bindDeviceData() {\n            if (this.vehicleType && this.curImei) {\n                httpClient.post('/api/v1/clouddrive/device/box/bind', {\n                    deviceImei: this.curImei,\n                    vehicleId: this.vehicleType\n                }).then(res => {\n                    if (res.data.code == 200 && res.data.data.result) {\n                        this.reload();\n                    } else {\n                        alert(res.data.data.content);\n                    }\n                });\n            }\n        },\n        prevPage(){\n            this.initData(this.currentPage > 1  ? this.currentPage - 1 : 1)\n        },\n        nextPage(){\n            this.initData(this.currentPage >= this.pageCount  ? this.currentPage : this.currentPage + 1)\n        },\n        changePage(page) {\n            this.initData(page);\n        }\n    }\n}\n",null]}