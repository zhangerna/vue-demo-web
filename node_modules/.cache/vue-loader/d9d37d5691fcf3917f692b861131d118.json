{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/testUserVerify.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/testDrive/testUserVerify.vue","mtime":1570770081000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nimport {getDateString} from \"@/utils/date\";\n\nexport default {\n    name: \"testUserVerify\",\n    inject: ['reload'],\n    data() {\n        return {\n            data: {},\n            showMap: false,\n            updateUserStatus:false,\n            updateUserText:'',\n            map: {},\n            show: false,\n            updateInfo: '',\n            markedAt: '',\n            table: null,\n            idcardVerifyTime: null,\n            driverLicenseverifyTime: null,\n            idcardName: 'N/A',\n            idcardGender: 'N/A',\n            idcardNation: 'N/A',\n            idcardBirthDate: 'N/A',\n            idcardAddress: 'N/A',\n            idcardNumber: 'N/A',\n            idcardOrganization: 'N/A',\n            idcardExpireDate: 'N/A',\n            licenseNumber: 'N/A',\n            licenseName: 'N/A',\n            licenseGender: 'N/A',\n            licenseCountry: 'N/A',\n            licenseAddress: 'N/A',\n            licenseBirthDate: 'N/A',\n            licenseInitDate: 'N/A',\n            licenseCarClass: 'N/A',\n            licenseExpireDate: 'N/A',\n            selected_reason: 'null',\n            submitAuthTime:null,\n            reasonList: [\n                {value: 'null', text: this.$t('m.add_shop.please_select')},\n                {value: 1, text: this.$t('m.cloud.verify_success')},\n                {value: 2, text: this.$t('m.cloud.idcard_verify_failed')},\n                {value: 3, text: this.$t('m.cloud.license_verify_failed')},\n                {value: 4, text: this.$t('m.cloud.difference_idcard_license')}\n            ]\n        }\n    },\n    mounted() {\n        httpClient.get('/api/v1/clouddrive/user/detail?userId=' + this.$route.params.id)\n            .then(response => {\n                if (response.data.code == 200) {\n                    this.data = response.data.data;\n                    this.idcardVerifyTime = getDateString(this.data.idCardResponse.certificationTime);\n                    this.driverLicenseverifyTime = getDateString(this.data.driveLicenseResponse.certificationTime);\n                    this.submitAuthTime = this.data.submitAuthTime ? getDateString(this.data.submitAuthTime) :0;\n                    if (response.data.data.idCardResponse) {\n                        let data = response.data.data.idCardResponse;\n                        this.idcardName = data.userName;\n                        this.idcardGender = data.gender? (data.gender === 1 ? this.$t('m.common.boy') :(data.gender === 2 ? this.$t('m.common.girl'):'N/A')) : '';\n                        this.idcardNation = data.ethnicGroup;\n                        this.idcardBirthDate = data.birthDate;\n                        this.idcardAddress = data.address;\n                        this.idcardNumber = data.idcardNumber;\n                        this.idcardOrganization = data.issuingOrganization;\n                        this.idcardExpireDate = data.expireDate;\n                    }\n                    if (response.data.data.driveLicenseResponse) {\n                        let data = response.data.data.driveLicenseResponse;\n                        this.licenseNumber = data.drivingLicenseNumber;\n                        this.licenseName = data.userName;\n                        this.licenseGender = data.gender ? (data.gender === 1 ? this.$t('m.common.boy') :this.$t('m.common.girl')) :'';\n                        this.licenseCountry = data.nationality;\n                        this.licenseAddress = data.address;\n                        this.licenseBirthDate = data.birthDate;\n                        this.licenseInitDate = data.initialDrivingLicenseDate;\n                        this.licenseCarClass = data.quasiDrivingModel;\n                        this.licenseExpireDate = data.expireDate;\n                    }\n\n                }\n            })\n    },\n    methods: {\n        filterData(data) {\n            this.table = data.map((item) => {\n                return {\n                    orderId: item.orderServiceNum,\n                    id: item.orderId,\n                    phone: item.phone,\n                    year: item.vehicleYear,\n                    make: item.vehicleMake,\n                    model: item.vehicleModel,\n                    color: item.vehicleColor,\n                    alias: item.vehicleAlias,\n                    trim: item.vehicleTrim,\n                    plat: item.vehiclePlate,\n                    num: item.vehiclePlate, // 库存编号\n                    testInfo: item.parkingName,\n                    pointTime: item.appointmentStartTime + \"~\" + item.appointmentEndTime,\n                    status: item.orderStatus,\n                }\n            });\n        },\n        saveUserInfo() {//提交用户的信息\n            let driveLicenseResponse = {\n                address:this.licenseAddress,\n                birthDate:this.licenseBirthDate,\n                drivingLicenseNumber:this.licenseNumber,\n                userName: this.licenseName,\n                gender:this.licenseGender === '男' ? 1:2,\n                nationality:this.licenseCountry,\n                initialDrivingLicenseDate:this.licenseInitDate,\n                quasiDrivingModel:this.licenseCarClass,\n                expireDate:this.licenseExpireDate,\n            };\n            let idCardResponse = {\n                userName:this.idcardName,\n                gender:this.idcardGender === '男' ? 1:2,\n                ethnicGroup:this.idcardNation,\n                birthDate:this.idcardBirthDate,\n                address:this.idcardAddress,\n                idcardNumber:this.idcardNumber,\n                issuingOrganization:this.idcardOrganization,\n                expireDate:this.idcardExpireDate\n            };\n\n            let verifyStatus = this.selected_reason;\n\n            let data = {\n                idCardResponse:idCardResponse,\n                driveLicenseResponse:driveLicenseResponse,\n                check:verifyStatus,\n                dUserId: this.$route.params.id\n            };\n\n            console.log(data)\n\n\n            httpClient.post('/api/v1/clouddrive/user/checkcard',data).then(res=>{\n                if(res.data.code === 200 && res.data.data.result === true){\n                    this.updateUserStatus = true;\n                    this.updateUserText = this.$t('m.tip.update_succ')\n                }else{\n                    this.updateUserStatus = true;\n                    this.updateUserText = this.$t('m.tip.update_failed')\n                }\n            }).catch(err=>{\n                console.log(err)\n            })\n        }\n    }\n}\n",null]}