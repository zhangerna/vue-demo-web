{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/shopEdit.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/shopEdit.vue","mtime":1574414921000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nimport model from \"@/components/model\";\nexport default {\n    name: \"addShop\",\n    components: {\n        model\n    },\n    data() {\n        return {\n            btnGroup: {\n                btnFirst: this.$t('m.common.b_cancel'),\n                btnSecond:this.$t('m.common.confirm')\n            },\n            showTip: false,\n            saveStatus:false,\n            title: \"\",\n            info: \"\",\n            name: \"\",\n            list: [],\n            country: '',\n            state: '',\n            city: '',\n            street: \"\",\n            cityE: false,\n            stateE: false,\n            countryE: false,\n            apartment: \"\",\n            zipCode: \"\",\n            zipE: false,\n            apartE: false,\n            streetE: false,\n            nameE: false,\n            hasSubmit: false,\n            managerE: false,\n            managerList: []\n        }\n    },\n    mounted () {\n        if (this.$route.params.id) {\n            httpClient.get(\"/api/v1/store/detail?storeId=\" + this.$route.params.id, {\n            }).then((res) => {\n                if (res.data.code == 200) {\n                    httpClient.get(\"/api/v1/getprovicescity\").then((resp) => {\n                        if (resp.data.code == 200) {\n                            this.list = resp.data.data.countryList;\n                            this.filterCountry(res.data.data.countryEn, res.data.data.stateEn, res.data.data.cityEn)\n                        }\n                    });\n                    for (let item of res.data.data.userList) {\n                        this.managerList.push({\n                            email: item.userEmail,\n                            phone: item.userPhone,\n                            lastName: item.lastName,\n                            firstName: item.firstName,\n                            ori: true\n                        })\n                    }\n                    this.managerList.length == 0 ? this.managerList.push({\n                            email: \"\",\n                            phone: \"\",\n                            lastName: \"\",\n                            firstName: \"\"}) : '';\n                    this.name = res.data.data.storeName;\n                    this.street = res.data.data.streetAddress;\n                    this.apartment = res.data.data.storeAddress;\n                    this.zipCode = res.data.data.zipCode;\n                }\n            });\n        }\n    },\n    methods: {\n        reduceAdmin(index) {\n            this.managerList.splice(index, 1);\n        },\n        filterCountry(country, state, city) {\n            for (let i=0; i < this.list.length; i++) {\n                if (this.list[i].countryName == country) {\n                    this.country = i + 1;\n                }\n            }\n            if (this.country) {\n                for (let i=0; i < this.list[this.country - 1].proviceList.length; i++) {\n                    if (this.list[this.country - 1].proviceList[i].proviceName == state) {\n                        this.state = i + 1;\n                    }\n                }\n            }\n            if (this.country && this.state) {\n                for (let k=0; k < this.list[this.country - 1].proviceList[this.state - 1].cityList.length; k++) {\n                    if (this.list[this.country - 1].proviceList[this.state - 1].cityList[k].cityName == city) {\n                        this.city = k + 1;\n                    }\n                }\n            }\n\n        },\n        addAdmin() {\n            this.managerList.push(\n                {\n                    email: \"\",\n                    phone: \"\",\n                    lastName: \"\",\n                    firstName: \"\"\n                }\n            )\n        },\n        checkData() {\n            this.hasSubmit = true;\n            this.nameE = this.name ? false : true;\n            this.zipE = this.zipCode ? false : true;\n            this.streetE = this.street ? false : true;\n            this.apartE = this.apartment ? false : true;\n            this.countryE = this.country ? false : true;\n            this.stateE = this.state ? false : true;\n            this.cityE = this.city ? false : true;\n            for (let item of this.managerList) {\n                if (!item.email || item.email.indexOf(\"@\") < 0 || !item.phone || !item.lastName || !item.firstName) {\n                    this.managerE = true;\n                }\n            }\n\n        },\n        updateData() {\n            this.checkData();\n            console.log(this.nameE,this.zipE, this.streetE, this.apartE, this.managerE, this.countryE);\n            if (!this.nameE && !this.zipE && !this.streetE && !this.apartE && !this.managerE && !this.countryE && !this.stateE && !this.cityE) {\n                httpClient.post('/api/v1/store/update', {\n                    insertSaasTenantStoreDTO: {\n                        id: this.$route.params.id,\n                        cityCode: this.list[this.country - 1]['proviceList'][this.state - 1]['cityList'][this.city - 1].cityId,\n                        countryCode: this.list[this.country - 1].countryId,\n                        stateCode: this.list[this.country - 1]['proviceList'][this.state - 1].provicesId,\n                        storeAddress: this.apartment,\n                        storeName: this.name,\n                        streetAddress: this.street,\n                        zipCode: this.zipCode\n                    },\n                    inviteUserParamDTO: this.managerList\n                }).then((res) => {\n                    //弹窗\n                    if(res.data.code === 200 && res.data.data.result){\n                        this.saveStatus = true\n                    }\n                })\n            } else {\n                alert('请检查输入数据');\n            }\n        },\n        saveAndLink(){\n            this.$router.push('/inventory/shop-manager/list');\n        }\n    }\n}\n",{"version":3,"sources":["shopEdit.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA0IA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shopEdit.vue","sourceRoot":"src/views/dashboard/dashboardMain","sourcesContent":["<template>\n    <div class=\"animated fadeIn add-shop\">\n        <b-card>\n            <div slot=\"header\">\n                {{ $t('m.shop.edit_shop') }}\n            </div>\n            <div class=\"container\">\n                <div class=\"warn-info text-center\">\n                    <p>{{ $t('m.edit_shop.p1') }}</p>\n                    <p>{{ $t('m.edit_shop.p2') }}</p>\n                    <p class=\"shop-warn\">{{ $t('m.edit_shop.p3') }}</p>\n                </div>\n                <div class=\"content\">\n                    <b-row>\n                        <b-col sm=\"12\" md=\"12\">\n                            <b-form-group>\n                                <label><strong class=\"text-muted\">{{ $t('m.shop.shop_name') }}</strong></label>\n                                <b-form-input type=\"text\" :class=\"nameE ? 'is-invalid' : ''\"  v-model=\"name\"></b-form-input>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <b-row>\n                        <b-col sm=\"12\" md=\"12\">\n                            <b-form-group>\n                                <b-row>\n                                    <b-col sm=\"4\">\n                                        <label><strong class=\"text-muted\">{{ $t('m.add_shop.country') }}</strong></label>\n                                        <select class=\" form-control\" v-model=\"country\" :class=\"countryE ? 'is-invalid' : ''\">\n                                            <option value=\"\" disabled selected>{{ $t('m.add_shop.please_select') }}</option>\n                                            <option v-for=\"(item, key) in list\" :key=\"key\" :value=\"key + 1\">{{ $i18n.locale == 'en-US' ? item.countryName : item.countryCName }}</option>\n                                        </select>\n                                    </b-col>\n                                    <b-col sm=\"4\">\n                                        <label><strong class=\"text-muted\">{{ $t('m.add_shop.state') }}</strong></label>\n                                        <select class=\"form-control\" v-model=\"state\" :class=\"stateE ? 'is-invalid' : ''\">\n                                            <option value=\"\" disabled selected>{{ $t('m.add_shop.please_select') }}</option>\n                                            <option v-for=\"(item, key) in (country ? list[country - 1]['proviceList'] : [])\" :value=\"key + 1\" :key=\"key\">{{ $i18n.locale == 'en-US' ? item.proviceName : item.proviceCName }}</option>\n                                        </select>\n                                    </b-col>\n                                    <b-col sm=\"4\">\n                                        <label><strong class=\"text-muted\">{{ $t('m.add_shop.city') }}</strong></label>\n                                        <select class=\"form-control\" v-model=\"city\" :class=\"cityE ? 'is-invalid' : ''\">\n                                            <option value=\"\" disabled selected>{{ $t('m.add_shop.please_select') }}</option>\n                                            <option v-for=\"(item, key) in (country && state ? list[country - 1]['proviceList'][state - 1]['cityList'] : [] )\" :value=\"key + 1\" :key=\"key\">{{ $i18n.locale == 'en-US' ? item.cityName : item.cityCName }}</option>\n                                        </select>\n                                    </b-col>\n                                </b-row>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <b-row>\n                        <b-col sm=\"12\" md=\"12\">\n                            <label><strong class=\"text-muted\">{{ $t('m.add_shop.label_address') }}</strong></label>\n                            <b-form-group>\n                                <b-form-input type=\"text\" :class=\"streetE ? 'is-invalid' : ''\" v-model=\"street\" placeholder=\"Street and number, P.O. box, c/o.\"></b-form-input>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <b-row>\n                        <b-col sm=\"12\" md=\"12\">\n                            <b-form-group>\n                                <b-form-input type=\"text\" :class=\"apartE ? 'is-invalid' : ''\" v-model=\"apartment\" placeholder=\"Apartment, suite, unit, building, floor, etc.\"></b-form-input>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <b-row>\n                        <b-col sm=\"12\" md=\"12\">\n                            <b-form-group>\n                                <b-form-input type=\"text\" :class=\"zipE ? 'is-invalid' : ''\" v-model=\"zipCode\" placeholder=\"Zip Code\"></b-form-input>\n                            </b-form-group>\n                        </b-col>\n                    </b-row>\n                    <div class=\"admin-info\">\n                        <b-row v-for=\"(item, index) in managerList\" :key=\"index\">\n                            <b-col sm=\"4\" md=\"4\">\n                                <b-form-group>\n                                    <div><strong class=\"text-muted\">{{ $t('m.add_shop.manager') + (index+1) }}</strong></div>\n                                    <label><strong class=\"text-muted\">{{ $t('m.add_shop.manager_email') }}</strong></label>\n                                    <b-form-input type=\"email\" :disabled=\"item.ori ? true : false\" :class=\"hasSubmit && (!managerList[index]['email'] || managerList[index]['email'].indexOf('@') < 0)  ? 'is-invalid' : '' \"  v-model=\"managerList[index]['email']\"></b-form-input>\n                                </b-form-group>\n                            </b-col>\n                            <b-col sm=\"4\" md=\"4\">\n                                <b-form-group>\n                                    <div><strong class=\"text-muted\">&nbsp;</strong></div>\n                                    <label><strong class=\"text-muted\">{{ $t('m.add_shop.manager_phone') }}</strong></label>\n                                    <b-form-input type=\"number\" :disabled=\"item.ori ? true : false\" :class=\"hasSubmit && !managerList[index]['phone'] ? 'is-invalid' : '' \"  v-model=\"managerList[index]['phone']\"></b-form-input>\n                                </b-form-group>\n                            </b-col>\n                            <b-col sm=\"2\" md=\"2\">\n                                <b-form-group>\n                                    <div><strong class=\"text-muted\">&nbsp;</strong></div>\n                                    <label><strong class=\"text-muted\">{{ $t('m.add_shop.manager_lname') }}</strong></label>\n                                    <b-form-input type=\"text\" :disabled=\"item.ori ? true : false\" :class=\"hasSubmit && !managerList[index]['lastName'] ? 'is-invalid' : '' \"  v-model=\"managerList[index]['lastName']\"></b-form-input>\n                                </b-form-group>\n                            </b-col>\n                            <b-col sm=\"2\" md=\"2\">\n                                <b-form-group>\n                                    <div><strong class=\"text-muted\">&nbsp;</strong></div>\n                                    <label><strong class=\"text-muted\">{{ $t('m.add_shop.manager_fname') }}</strong></label>\n                                    <b-form-input type=\"text\" :disabled=\"item.ori ? true : false\" :class=\"hasSubmit && !managerList[index]['firstName'] ? 'is-invalid' : '' \"  v-model=\"managerList[index]['firstName']\"></b-form-input>\n                                </b-form-group>\n                                <div class=\"add\">\n                                    <i style=\"font-size: 20px;margin-right: 10px;\" @click=\"addAdmin\" class=\"fa fa-plus-square\"></i>\n                                    <i style=\"font-size: 20px;color:red\" v-if=\"index != 0\" @click=\"reduceAdmin(index)\" class=\"fa fa-minus-square\"></i>\n                                </div>\n                            </b-col>\n                        </b-row>\n                    </div>\n                    <div class=\"text-center\">\n                        <button class=\"btn btn-sm btn-primary\" @click=\"updateData()\">\n                            {{ $t('m.common.b_save') }}\n                        </button>\n                    </div>\n                </div>\n            </div>\n        </b-card>\n        <model\n                :show=\"showTip\"\n                :title=\"title\"\n                :content=\"info\"\n                :buttonText=\"btnGroup\"\n        ></model>\n\n        <b-modal ref=\"my-modal-6\" v-model=\"saveStatus\" :ok-title=\"$t('m.tip.confirm')\"\n                 @ok=\"saveAndLink()\"  class=\"select-store\" ok-only>\n            <template slot=\"modal-title\">\n                {{ $t('m.tip.suc') }}\n            </template>\n            <div class=\"text-left\">\n                {{ $t('m.tip.edit_succ') }}\n            </div>\n        </b-modal>\n\n\n    </div>\n</template>\n\n<script>\n    import httpClient from \"@/utils/httpclient\";\n    import model from \"@/components/model\";\n    export default {\n        name: \"addShop\",\n        components: {\n            model\n        },\n        data() {\n            return {\n                btnGroup: {\n                    btnFirst: this.$t('m.common.b_cancel'),\n                    btnSecond:this.$t('m.common.confirm')\n                },\n                showTip: false,\n                saveStatus:false,\n                title: \"\",\n                info: \"\",\n                name: \"\",\n                list: [],\n                country: '',\n                state: '',\n                city: '',\n                street: \"\",\n                cityE: false,\n                stateE: false,\n                countryE: false,\n                apartment: \"\",\n                zipCode: \"\",\n                zipE: false,\n                apartE: false,\n                streetE: false,\n                nameE: false,\n                hasSubmit: false,\n                managerE: false,\n                managerList: []\n            }\n        },\n        mounted () {\n            if (this.$route.params.id) {\n                httpClient.get(\"/api/v1/store/detail?storeId=\" + this.$route.params.id, {\n                }).then((res) => {\n                    if (res.data.code == 200) {\n                        httpClient.get(\"/api/v1/getprovicescity\").then((resp) => {\n                            if (resp.data.code == 200) {\n                                this.list = resp.data.data.countryList;\n                                this.filterCountry(res.data.data.countryEn, res.data.data.stateEn, res.data.data.cityEn)\n                            }\n                        });\n                        for (let item of res.data.data.userList) {\n                            this.managerList.push({\n                                email: item.userEmail,\n                                phone: item.userPhone,\n                                lastName: item.lastName,\n                                firstName: item.firstName,\n                                ori: true\n                            })\n                        }\n                        this.managerList.length == 0 ? this.managerList.push({\n                                email: \"\",\n                                phone: \"\",\n                                lastName: \"\",\n                                firstName: \"\"}) : '';\n                        this.name = res.data.data.storeName;\n                        this.street = res.data.data.streetAddress;\n                        this.apartment = res.data.data.storeAddress;\n                        this.zipCode = res.data.data.zipCode;\n                    }\n                });\n            }\n        },\n        methods: {\n            reduceAdmin(index) {\n                this.managerList.splice(index, 1);\n            },\n            filterCountry(country, state, city) {\n                for (let i=0; i < this.list.length; i++) {\n                    if (this.list[i].countryName == country) {\n                        this.country = i + 1;\n                    }\n                }\n                if (this.country) {\n                    for (let i=0; i < this.list[this.country - 1].proviceList.length; i++) {\n                        if (this.list[this.country - 1].proviceList[i].proviceName == state) {\n                            this.state = i + 1;\n                        }\n                    }\n                }\n                if (this.country && this.state) {\n                    for (let k=0; k < this.list[this.country - 1].proviceList[this.state - 1].cityList.length; k++) {\n                        if (this.list[this.country - 1].proviceList[this.state - 1].cityList[k].cityName == city) {\n                            this.city = k + 1;\n                        }\n                    }\n                }\n\n            },\n            addAdmin() {\n                this.managerList.push(\n                    {\n                        email: \"\",\n                        phone: \"\",\n                        lastName: \"\",\n                        firstName: \"\"\n                    }\n                )\n            },\n            checkData() {\n                this.hasSubmit = true;\n                this.nameE = this.name ? false : true;\n                this.zipE = this.zipCode ? false : true;\n                this.streetE = this.street ? false : true;\n                this.apartE = this.apartment ? false : true;\n                this.countryE = this.country ? false : true;\n                this.stateE = this.state ? false : true;\n                this.cityE = this.city ? false : true;\n                for (let item of this.managerList) {\n                    if (!item.email || item.email.indexOf(\"@\") < 0 || !item.phone || !item.lastName || !item.firstName) {\n                        this.managerE = true;\n                    }\n                }\n\n            },\n            updateData() {\n                this.checkData();\n                console.log(this.nameE,this.zipE, this.streetE, this.apartE, this.managerE, this.countryE);\n                if (!this.nameE && !this.zipE && !this.streetE && !this.apartE && !this.managerE && !this.countryE && !this.stateE && !this.cityE) {\n                    httpClient.post('/api/v1/store/update', {\n                        insertSaasTenantStoreDTO: {\n                            id: this.$route.params.id,\n                            cityCode: this.list[this.country - 1]['proviceList'][this.state - 1]['cityList'][this.city - 1].cityId,\n                            countryCode: this.list[this.country - 1].countryId,\n                            stateCode: this.list[this.country - 1]['proviceList'][this.state - 1].provicesId,\n                            storeAddress: this.apartment,\n                            storeName: this.name,\n                            streetAddress: this.street,\n                            zipCode: this.zipCode\n                        },\n                        inviteUserParamDTO: this.managerList\n                    }).then((res) => {\n                        //弹窗\n                        if(res.data.code === 200 && res.data.data.result){\n                            this.saveStatus = true\n                        }\n                    })\n                } else {\n                    alert('请检查输入数据');\n                }\n            },\n            saveAndLink(){\n                this.$router.push('/inventory/shop-manager/list');\n            }\n        }\n    }\n</script>\n\n<style lang=\"scss\" scoped>\n    .warn-info {\n        padding: 2px;\n        background: #e4e5e6;\n        p {\n            margin-bottom: 4px;\n        }\n        .shop-warn {\n            color: #c00;\n        }\n    }\n    .is-invalid {\n        border: 1px solid red;\n    }\n    .container {\n        .content {\n            width: 60%;\n            margin: 0 auto;\n            padding-top: 20px;\n            position: relative;\n        }\n        .add {\n            position: absolute;\n            right: -50px;\n            margin-top: -44px;\n            width: 50px;\n            .add-icon {\n                color: #ffffff;\n                background: black;\n                padding: 3px 4px;\n                border-radius: 50%;\n            }\n        }\n    }\n</style>\n"]}]}