{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/device.vue","mtime":1569468807000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/thread-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nimport model from \"@/components/model\";\nimport {getDateString} from \"@/utils/date\";\nexport default {\n    name: \"device\",\n    inject: ['reload'],\n    components: {\n        model\n    },\n    data(){\n        return {\n            tableFields: {\n                imei: {\n                    label: this.$t('m.common.imei2'),\n                    class: \"text-center\"\n                },\n                deviceType: {\n                    label: this.$t('m.cloud.device_type')\n                },\n                vin: {\n                    label: this.$t('m.common.vin2'),\n                    class: \"text-center\"\n                },\n                updateTime: {\n                    label: this.$t('m.cloud.last_update_time'),\n                    class: \"text-center\"\n                },\n                actions: {\n                    label: this.$t('m.vehicle.actions'),\n                    class: \"Actions\"\n                }\n            },\n            table: null,\n            currentPage: 1,\n            pageSize: 10,\n            total: 0,\n            totalPages:0,\n            show: false,\n            unpairVin: '',\n            title: '',\n            content: '',\n            btnGroup: {btnFirst: this.$t('m.tip.b_cancel'), btnSecond: this.$t('m.tip.b_ok')},\n            delId: '',\n            currentOpa: false,\n            searchText:''\n\n        }\n    },\n    mounted() {\n        this.initData(this.currentPage, this.pageSize);\n    },\n    methods: {\n        initData(page) {\n            httpClient.post(`/api/v1/vehicle/listBindDevice?pageNo=${page}&pageSize=${this.pageSize}`).\n            then(response => {\n                this.total = response.data.data.rowCount;\n                this.filterData(response.data.data);\n                this.totalPages = response.data.data.totalPages\n            })\n        },\n        filterData(data) {\n            this.table = data.datas.map((item) => {\n                return {\n                    imei: item.deviceMac,\n                    vin: item.vin ? item.vin : 'N/A',\n                    id: item.vehicleId,\n                    deviceType: item.deviceType ? (item.deviceType === 1 ? this.$t('m.cloud.device_name_nonda') :this.$t('m.cloud.device_name_chelian')) : 'N/A',\n                    deviceId: item.deviceId,\n                    updateTime:getDateString(item.updateTime)\n                }\n            });\n\n        },\n        changePage(page) {\n            this.initData(page, this.pageSize);\n        },\n        unpairVehicle(id, imei){\n            this.unpairVin = {\n                vin: id,\n                deviceMac: imei\n            };\n            this.currentOpa = 'unpair';\n            this.show = true;\n            this.title = this.$t('m.tip.confirm');\n            this.content = this.$t('m.tip.unpair');\n        },\n        unbindVIn() {\n            httpClient.post('/api/v1/vehicle/unbind/device', {\n                deviceMac: this.unpairVin.deviceMac,\n                vin: this.unpairVin.vin\n            }).then(response => {\n                if (response.data.code == 200) {\n                    this.reload();\n                } else {\n                    this.show = true;\n                    this.title = this.$t('m.tip.error');\n                    this.content = this.$t('m.tip.unbind_err');\n                    this.btnGroup.btnSecond = '';\n                }\n            })\n        },\n        delDevice() {\n            httpClient.post('/api/v1/device/delete', {\n                deviceId: this.delId\n            }).then(response => {\n                if (response.data.code == 200) {\n                    this.reload();\n                } else {\n                    this.show = true;\n                    this.title = this.$t('m.tip.error');\n                    this.content = this.$t('m.tip.delete_err');\n                    this.btnGroup.btnSecond = '';\n                }\n            })\n        },\n        closeBox(type) {\n            if (type) {\n                this.currentOpa == \"del\" ? this.delDevice() : this.unbindVIn();\n            } else {\n                this.show = false;\n            }\n        },\n        delIdM(id) {\n            this.delId = id;\n            this.currentOpa = 'del';\n            this.show = true;\n            this.title = this.$t('m.tip.warn');\n            this.content = this.$t('m.tip.del_device');\n        },\n        searchResult(){\n            httpClient.post(`/api/v1/vehicle/listBindDevice`,{imei:this.searchText}).then(res=>{\n                this.total = res.data.data.rowCount;\n                this.filterData(res.data.data);\n                this.totalPages = res.data.data.totalPages;\n            })\n        }\n    }\n}\n",null]}