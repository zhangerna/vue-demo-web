{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/vehicle.vue","mtime":1560750572000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpclient from '@/utils/httpclient';\nimport googleMap from '@components/googleMap'\nexport default {\n\tname: \"vehicle\",\n\tcomponents: {\n\t\tgoogleMap\n\t},\n\tinject: [\"reload\"],\n\tdata(){\n\t\treturn {\n\t\t\ttableFields: {\n\t\t\t\tphotoUrl: {\n\t\t\t\t\tlabel: 'Photo',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tvehicle: {\n\t\t\t\t\tlabel: 'Vehicle',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tpark: {\n\t\t\t\t\tlabel: 'Lot',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tbattery: {\n\t\t\t\t\tlabel: 'Voltage',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tonline: {\n\t\t\t\t\tlabel: 'Online/Offline',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tuse: {\n\t\t\t\t\tlabel: 'Available/In Use',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tprice: {\n\t\t\t\t\tlabel: 'Price',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\tinventory: {\n\t\t\t\t\tlabel: 'Inventory Age',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t},\n\t\t\t\taction: {\n\t\t\t\t\tlabel: 'Actions',\n\t\t\t\t\tclass: 'text-center'\n\t\t\t\t}\n\t\t\t},\n\t\t\tdata: null,\n\t\t\ttable: null,\n\t\t\tshowMap: false,\n\t\t\tmap: {},\n\t\t\trows: 0,\n\t\t\tcurrentPage: 1,\n\t\t\ttotal: 0,\n\t\t\tperPage:10,\n\t\t\tshowDelMap: false,\n\t\t\tdelId: '',\n\t\t\tshowEtip: false,\n\t\t\tpageCount: 0,\n\t\t\tgFData: [],\n\t\t\tsearch: '',\n\t\t\tqueryData:{},\n\t\t}\n\t},\n\tmounted() {\n\t\tlet self = this;\n\t\tthis.axiosApi(self, 1, this.$route.query.filters ? JSON.parse(this.$route.query.filters) : []);\n\t\tthis.getFilter();\n\t\t//初始化checkbox勾选\n\t\tlet myData = this.$route.query.filters ? JSON.parse(this.$route.query.filters) : [];\n\t\tif(myData.length){\n\t\t\tmyData.map((item,i)=>{\n\t\t\t\tthis.queryData[item.key] = item.value;\n\t\t\t})\n\t\t}\n\n\t},\n\tmethods: {\n\t\tgetFilter() {\n\t\t\thttpclient.post('/api/v1/vehiclesearch/filter').then(response => {\n\t\t\t\tthis.gFData = response.data.data;\n\t\t\t}).catch(() => {\n\t\t\t});\n\t\t},\n\t\tsearchData() {\n\t\t\tlet search= [];\n\t\t\tlet keys = [];\n\t\t\tthis.$refs.checkbox.forEach((item) => {\n\t\t\t\tif (item.is_Checked) {\n\t\t\t\t\tif (keys.includes(item.name)) {\n\t\t\t\t\t\tfor (let it of search) {\n\t\t\t\t\t\t\tif (it.key == item.name) it.value.push(item.value);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsearch.push({\n\t\t\t\t\t\t\tkey: item.name,\n\t\t\t\t\t\t\tvalue: [item.value]\n\t\t\t\t\t\t});\n\t\t\t\t\t\tkeys.push(item.name)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis.axiosApi(this, 1, search);\n\n\t\t},\n\t\taxiosApi(self, page, obj){\n\t\t\thttpclient.post(`/api/v1/vehiclesearch/searchnew?searchText=${this.search}&source=&pageNo=${page}&pageSize=10`, {\n\t\t\t\tfilters: obj\n\t\t\t}).then((response) => {\n\t\t\t\tself.data = response.data.data;\n\t\t\t\tself.total = response.data.data.rowCount ? response.data.data.rowCount : 0 ;\n\t\t\t\tself.currentPage = response.data.data.pageNo ? response.data.data.pageNo : 0;\n\t\t\t\tself.pageCount = response.data.data.pageCount ? response.data.data.pageCount : 0;\n\t\t\t\tthis.filterData(self.data.vehicles);\n\t\t\t}).catch((err) => {\n\t\t\t\talert(err)\n\t\t\t})\n\t\t},\n\t\tformatNumber(nStr){\n\t\t\tnStr += '';\n\t\t\tlet x = nStr.split('.');\n\t\t\tlet x1 = x[0];\n\t\t\tlet x2 = x.length > 1 ? '.' + x[1] : '';\n\t\t\tvar rgx = /(\\d+)(\\d{3})/;\n\t\t\twhile (rgx.test(x1)) {\n\t\t\t\tx1 = x1.replace(rgx, '$1' + ',' + '$2');\n\t\t\t}\n\t\t\treturn x1 + x2;\n\t\t},\n\t\tchangePage(page) {\n\t\t\tlet self = this;\n\t\t\tthis.axiosApi(self, page, []);\n\t\t},\n\t\tapiDel() {\n\t\t\thttpclient.post('/api/v1/vehicle/delete',{\n\t\t\t\tvehicleId: this.delId\n\t\t\t}).then(response => {\n\t\t\t\tif (response.data.code == 200) {\n\t\t\t\t\tthis.reload();\n\t\t\t\t} else {\n\t\t\t\t\tthis.showEtip = true;\n\t\t\t\t}\n\t\t\t}).catch(() => {\n\t\t\t\tthis.showEtip = true;\n\t\t\t})\n\t\t},\n\t\tshowMapTip(lat, lng, area, info) {\n\t\t\tif (lat || area) {\n\t\t\t\tthis.map = {\n\t\t\t\t\tlat: lat,\n\t\t\t\t\tlng: lng,\n\t\t\t\t\tarea: area,\n\t\t\t\t\tvehicleInfo: info\n\t\t\t\t};\n\t\t\t\tthis.showMap = true;\n\t\t\t}\n\t\t},\n\t\thideModal(){\n\t\t\tthis.$refs['my-modal'].hide();\n\t\t},\n\t\tdelData(id){\n\t\t\tthis.delId = id;\n\t\t\tthis.showDelMap = true;\n\t\t},\n\t\tfilterData(data){\n\n\t\t\tlet self = this;\n\t\t\tthis.table = data.map(function (item) {\n\t\t\t\tlet pack = item.outStatus == 1 ? item.parkingName : \"N/A\";\n\t\t\t\tlet battery = null;\n\t\t\t\tlet batteryClass = null;\n\t\t\t\tif (item.currentVoltage) {\n\t\t\t\t\tlet numBat = item.currentVoltage.toFixed(1);\n\t\t\t\t\tbattery = item.currentVoltage.toFixed(1) + ' V';\n\t\t\t\t\tbatteryClass = numBat <= 11.7 ? 'badge-danger' : (numBat > 11.7 && numBat <= 12.1 ? 'badge-warning' : 'badge-success' );\n\t\t\t\t} else {\n\t\t\t\t\tbattery = \"N/A\";\n\t\t\t\t\tbatteryClass = 'badge-secondary';\n\t\t\t\t}\n\t\t\t\tlet onlineStatus = item.isOnline == 1 ? \"Online\" : \"Offline\";\n\t\t\t\tlet year = item.year ? item.year : 'N/A';\n\t\t\t\tlet make = item.make ? item.make : 'N/A';\n\t\t\t\tlet model = item.model ? item.model : 'N/A';\n\t\t\t\tlet info = (year == 'N/A' && make == 'N/A' && model == 'N/A') ? 'N/A' : year + ' ' + make + ' ' + model;\n\t\t\t\tlet color = item.color ? item.color : 'N/A';\n\t\t\t\tlet trim = item.trim ? item.trim : 'N/A';\n\t\t\t\tlet colorTrim = (color == 'N/A' && trim == 'N/A') ? 'N/A' : color + ' , ' + trim;\n\t\t\t\treturn {\n\t\t\t\t\t\"photoUrl\": item.photoUrl ? item.photoUrl : require(\"@/assets/pages-img/placeholder.svg\"),\n\t\t\t\t\t\"vehicle\": info,\n\t\t\t\t\t\"colorTrim\":colorTrim,\n\t\t\t\t\t\"stock\": item.stockNumber ? item.stockNumber : 'N/A',\n\t\t\t\t\t\"park\": pack,\n\t\t\t\t\t\"battery\": battery,\n\t\t\t\t\t\"batteryClass\": batteryClass,\n\t\t\t\t\t\"online\": onlineStatus,\n\t\t\t\t\t\"use\": item.available == 0 ? 'Available' : 'In Use',\n\t\t\t\t\t\"price\": item.price ? item.priceUnit + ' ' + self.formatNumber(item.price) : 'N/A',\n\t\t\t\t\t\"inventory\": item.inventoryDays ? item.inventoryDays + ' Days' : 'N/A',\n\t\t\t\t\t\"action\": \"<span>action</span>\",\n\t\t\t\t\t\"vehicleId\": item.vehicleId,\n\t\t\t\t\t\"unboundStatus\": item.isOnline == 3 ? 'Unbound' : '',\n\t\t\t\t\t\"info\": info,\n\t\t\t\t\t\"lat\": item.lastLocationLat,\n\t\t\t\t\t\"lng\": item.lastLocationLng,\n\t\t\t\t\t\"area\": item.areaCoordinates\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t}\n\n}\n",null]}