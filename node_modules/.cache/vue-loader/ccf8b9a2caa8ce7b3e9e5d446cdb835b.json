{"remainingRequest":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/bindVehicle.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/nonda/nonda/nonda-saas-web/src/views/dashboard/dashboardMain/bindVehicle.vue","mtime":1561106593000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/nonda/nonda/nonda-saas-web/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport httpClient from \"@/utils/httpclient\";\nimport VehicleForm from \"@/components/vehicleForm\";\nexport default {\n    name: \"bindVehicle\",\n    inject: [\"reload\"],\n    components: {\n        VehicleForm\n    },\n    data() {\n        return {\n            step1: true,\n            step2: false,\n            step3: false,\n            deviceId: null,\n            step1Button: true,\n            imeiIsVaild: false,\n            imeiSuccess: false,\n            imeiDisable: false,\n            step2Button: true,\n            title: '',\n            data1: {},\n            data2: null,\n            showTip: false,\n            vin: '',\n            vinDisable: false,\n            vinIsVaild: false,\n            vinSuccess: false,\n            isClickStep2: false,\n            vehicleId: ''\n        }\n    },\n    watch: {\n        deviceId(newV) {\n            if (newV.length == 15) {\n                this.deviceId = newV;\n                this.imeiDisable = true;\n                this.imeiIsVaild = false;\n                this.imeiSuccess = true;\n                this.step1Button = false;\n            } else {\n                this.imeiIsVaild = true;\n            }\n        },\n        vin(newV) {\n            if (newV.length == 17) {\n                this.vin = newV;\n                this.vinDisable = true;\n                this.vinIsVaild = false;\n                this.vinSuccess = false;\n                this.step2Button = false;\n                this.clickStep2();\n            } else {\n                this.vinIsVaild = true;\n            }\n        }\n    },\n    mounted() {\n        if (this.$route.query.deviceMac) {\n            this.step1 = false;\n            this.step2 = true;\n            this.deviceId = this.$route.query.deviceMac;\n        }\n    },\n    methods: {\n        reloadPage() {\n            window.location.reload();\n        },\n        unbind() {\n            httpClient.post('/api/v1/vehicle/unbind/device', {\n                deviceMac: this.deviceId,\n                vin: this.vin\n            }).then(response => {\n                if (response.data.code == 200) {\n                    this.vin = '';\n                    this.vinDisable = false;\n                    this.vinIsVaild = false;\n                    this.vinSuccess = false;\n                    this.step2Button = true;\n                    this.showTip = false;\n                    this.step1 = false;\n                    this.step2 = true;\n                } else {\n                    window.location.reload();\n                }\n            })\n        },\n        clickStep2() {\n            httpClient.get('/api/v1/vehicle/detail/vin?vin=' + this.vin, {\n            }).then(response => {\n                this.data2 = response.data.data;\n                this.data2.mac = this.deviceId;\n                if (this.data2.deviceMac == '') {\n                    this.isClickStep2 = true;\n                    this.vinSuccess = false;\n                } else {\n\n                }\n            })\n        },\n        showStep3(data) {\n            this.step1 = false;\n            this.step2 = false;\n            this.step3 = true;\n            this.vehicleId = data.vehicleId;\n        },\n        clickStep1() {\n            httpClient.post('/api/v1/device/vehiceldetail/mac', {\n                deviceMac: this.deviceId\n            }).then(response => {\n                this.data1 = response.data.data;\n                if (this.data1.vin == ''){\n                    this.step1 = false;\n                    this.step2 = true;\n                } else {\n                    this.vin = response.data.data.vin;\n                    this.title = `This device is currently paired with ${response.data.data.year} ${response.data.data.make} ${response.data.data.model} vin:${response.data.data.vin}`\n                    this.showTip = true;\n                }\n            }).catch(err => {\n                console.log(err);\n                this.vin = err.response.data.data.vin;\n                this.data1 = err.response.data.data;\n                this.title = `This device is currently paired with ${this.data1.year} ${this.data1.make} ${this.data1.model} vin:${this.data1.vin}`;\n                this.showTip = true;\n            })\n        }\n    }\n}\n",null]}